"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/accounts/route";
exports.ids = ["app/api/accounts/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Faccounts%2Froute&page=%2Fapi%2Faccounts%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Faccounts%2Froute.ts&appDir=C%3A%5CUsers%5CAdministrator%5C.cursor-projects%5Cprojects%5CCommissable%20CRM%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CAdministrator%5C.cursor-projects%5Cprojects%5CCommissable%20CRM&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Faccounts%2Froute&page=%2Fapi%2Faccounts%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Faccounts%2Froute.ts&appDir=C%3A%5CUsers%5CAdministrator%5C.cursor-projects%5Cprojects%5CCommissable%20CRM%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CAdministrator%5C.cursor-projects%5Cprojects%5CCommissable%20CRM&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_Administrator_cursor_projects_projects_Commissable_CRM_app_api_accounts_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/accounts/route.ts */ \"(rsc)/./app/api/accounts/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/accounts/route\",\n        pathname: \"/api/accounts\",\n        filename: \"route\",\n        bundlePath: \"app/api/accounts/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\Administrator\\\\.cursor-projects\\\\projects\\\\Commissable CRM\\\\app\\\\api\\\\accounts\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_Administrator_cursor_projects_projects_Commissable_CRM_app_api_accounts_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/accounts/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhY2NvdW50cyUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGYWNjb3VudHMlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZhY2NvdW50cyUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNBZG1pbmlzdHJhdG9yJTVDLmN1cnNvci1wcm9qZWN0cyU1Q3Byb2plY3RzJTVDQ29tbWlzc2FibGUlMjBDUk0lNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUMlM0ElNUNVc2VycyU1Q0FkbWluaXN0cmF0b3IlNUMuY3Vyc29yLXByb2plY3RzJTVDcHJvamVjdHMlNUNDb21taXNzYWJsZSUyMENSTSZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDbUQ7QUFDaEk7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jb21taXNzYWJsZS1jcm0vPzQ1ZjkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiQzpcXFxcVXNlcnNcXFxcQWRtaW5pc3RyYXRvclxcXFwuY3Vyc29yLXByb2plY3RzXFxcXHByb2plY3RzXFxcXENvbW1pc3NhYmxlIENSTVxcXFxhcHBcXFxcYXBpXFxcXGFjY291bnRzXFxcXHJvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9hY2NvdW50cy9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2FjY291bnRzXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9hY2NvdW50cy9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIkM6XFxcXFVzZXJzXFxcXEFkbWluaXN0cmF0b3JcXFxcLmN1cnNvci1wcm9qZWN0c1xcXFxwcm9qZWN0c1xcXFxDb21taXNzYWJsZSBDUk1cXFxcYXBwXFxcXGFwaVxcXFxhY2NvdW50c1xcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvYWNjb3VudHMvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Faccounts%2Froute&page=%2Fapi%2Faccounts%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Faccounts%2Froute.ts&appDir=C%3A%5CUsers%5CAdministrator%5C.cursor-projects%5Cprojects%5CCommissable%20CRM%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CAdministrator%5C.cursor-projects%5Cprojects%5CCommissable%20CRM&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/accounts/helpers.ts":
/*!*************************************!*\
  !*** ./app/api/accounts/helpers.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   accountIncludeForList: () => (/* binding */ accountIncludeForList),\n/* harmony export */   mapAccountToListRow: () => (/* binding */ mapAccountToListRow)\n/* harmony export */ });\nfunction mapAccountToListRow(account) {\n    return {\n        id: account.id,\n        active: account.status === \"Active\",\n        accountName: account.accountName,\n        accountLegalName: account.accountLegalName ?? \"\",\n        accountType: account.accountType?.name ?? \"\",\n        accountOwner: account.owner?.fullName ?? \"\",\n        shippingState: account.shippingAddress?.state ?? \"\",\n        shippingCity: account.shippingAddress?.city ?? \"\",\n        shippingZip: account.shippingAddress?.postalCode ?? \"\",\n        shippingStreet: account.shippingAddress?.line1 ?? \"\",\n        shippingStreet2: account.shippingAddress?.line2 ?? \"\"\n    };\n}\nconst accountIncludeForList = {\n    accountType: {\n        select: {\n            name: true\n        }\n    },\n    owner: {\n        select: {\n            fullName: true\n        }\n    },\n    shippingAddress: {\n        select: {\n            line1: true,\n            line2: true,\n            city: true,\n            state: true,\n            postalCode: true\n        }\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2FjY291bnRzL2hlbHBlcnMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBTyxTQUFTQSxvQkFBb0JDLE9BQVk7SUFDOUMsT0FBTztRQUNMQyxJQUFJRCxRQUFRQyxFQUFFO1FBQ2RDLFFBQVFGLFFBQVFHLE1BQU0sS0FBSztRQUMzQkMsYUFBYUosUUFBUUksV0FBVztRQUNoQ0Msa0JBQWtCTCxRQUFRSyxnQkFBZ0IsSUFBSTtRQUM5Q0MsYUFBYU4sUUFBUU0sV0FBVyxFQUFFQyxRQUFRO1FBQzFDQyxjQUFjUixRQUFRUyxLQUFLLEVBQUVDLFlBQVk7UUFDekNDLGVBQWVYLFFBQVFZLGVBQWUsRUFBRUMsU0FBUztRQUNqREMsY0FBY2QsUUFBUVksZUFBZSxFQUFFRyxRQUFRO1FBQy9DQyxhQUFhaEIsUUFBUVksZUFBZSxFQUFFSyxjQUFjO1FBQ3BEQyxnQkFBZ0JsQixRQUFRWSxlQUFlLEVBQUVPLFNBQVM7UUFDbERDLGlCQUFpQnBCLFFBQVFZLGVBQWUsRUFBRVMsU0FBUztJQUNyRDtBQUNGO0FBRU8sTUFBTUMsd0JBQXdCO0lBQ25DaEIsYUFBYTtRQUFFaUIsUUFBUTtZQUFFaEIsTUFBTTtRQUFLO0lBQUU7SUFDdENFLE9BQU87UUFBRWMsUUFBUTtZQUFFYixVQUFVO1FBQUs7SUFBRTtJQUNwQ0UsaUJBQWlCO1FBQ2ZXLFFBQVE7WUFBRUosT0FBTztZQUFNRSxPQUFPO1lBQU1OLE1BQU07WUFBTUYsT0FBTztZQUFNSSxZQUFZO1FBQUs7SUFDaEY7QUFDRixFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY29tbWlzc2FibGUtY3JtLy4vYXBwL2FwaS9hY2NvdW50cy9oZWxwZXJzLnRzPzJlNDIiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGZ1bmN0aW9uIG1hcEFjY291bnRUb0xpc3RSb3coYWNjb3VudDogYW55KSB7XG4gIHJldHVybiB7XG4gICAgaWQ6IGFjY291bnQuaWQsXG4gICAgYWN0aXZlOiBhY2NvdW50LnN0YXR1cyA9PT0gXCJBY3RpdmVcIixcbiAgICBhY2NvdW50TmFtZTogYWNjb3VudC5hY2NvdW50TmFtZSxcbiAgICBhY2NvdW50TGVnYWxOYW1lOiBhY2NvdW50LmFjY291bnRMZWdhbE5hbWUgPz8gXCJcIixcbiAgICBhY2NvdW50VHlwZTogYWNjb3VudC5hY2NvdW50VHlwZT8ubmFtZSA/PyBcIlwiLFxuICAgIGFjY291bnRPd25lcjogYWNjb3VudC5vd25lcj8uZnVsbE5hbWUgPz8gXCJcIixcbiAgICBzaGlwcGluZ1N0YXRlOiBhY2NvdW50LnNoaXBwaW5nQWRkcmVzcz8uc3RhdGUgPz8gXCJcIixcbiAgICBzaGlwcGluZ0NpdHk6IGFjY291bnQuc2hpcHBpbmdBZGRyZXNzPy5jaXR5ID8/IFwiXCIsXG4gICAgc2hpcHBpbmdaaXA6IGFjY291bnQuc2hpcHBpbmdBZGRyZXNzPy5wb3N0YWxDb2RlID8/IFwiXCIsXG4gICAgc2hpcHBpbmdTdHJlZXQ6IGFjY291bnQuc2hpcHBpbmdBZGRyZXNzPy5saW5lMSA/PyBcIlwiLFxuICAgIHNoaXBwaW5nU3RyZWV0MjogYWNjb3VudC5zaGlwcGluZ0FkZHJlc3M/LmxpbmUyID8/IFwiXCJcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgYWNjb3VudEluY2x1ZGVGb3JMaXN0ID0ge1xuICBhY2NvdW50VHlwZTogeyBzZWxlY3Q6IHsgbmFtZTogdHJ1ZSB9IH0sXG4gIG93bmVyOiB7IHNlbGVjdDogeyBmdWxsTmFtZTogdHJ1ZSB9IH0sXG4gIHNoaXBwaW5nQWRkcmVzczoge1xuICAgIHNlbGVjdDogeyBsaW5lMTogdHJ1ZSwgbGluZTI6IHRydWUsIGNpdHk6IHRydWUsIHN0YXRlOiB0cnVlLCBwb3N0YWxDb2RlOiB0cnVlIH1cbiAgfVxufVxuIl0sIm5hbWVzIjpbIm1hcEFjY291bnRUb0xpc3RSb3ciLCJhY2NvdW50IiwiaWQiLCJhY3RpdmUiLCJzdGF0dXMiLCJhY2NvdW50TmFtZSIsImFjY291bnRMZWdhbE5hbWUiLCJhY2NvdW50VHlwZSIsIm5hbWUiLCJhY2NvdW50T3duZXIiLCJvd25lciIsImZ1bGxOYW1lIiwic2hpcHBpbmdTdGF0ZSIsInNoaXBwaW5nQWRkcmVzcyIsInN0YXRlIiwic2hpcHBpbmdDaXR5IiwiY2l0eSIsInNoaXBwaW5nWmlwIiwicG9zdGFsQ29kZSIsInNoaXBwaW5nU3RyZWV0IiwibGluZTEiLCJzaGlwcGluZ1N0cmVldDIiLCJsaW5lMiIsImFjY291bnRJbmNsdWRlRm9yTGlzdCIsInNlbGVjdCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/accounts/helpers.ts\n");

/***/ }),

/***/ "(rsc)/./app/api/accounts/route.ts":
/*!***********************************!*\
  !*** ./app/api/accounts/route.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/db */ \"(rsc)/./lib/db.ts\");\n/* harmony import */ var _helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./helpers */ \"(rsc)/./app/api/accounts/helpers.ts\");\n/* harmony import */ var _lib_api_auth__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/api-auth */ \"(rsc)/./lib/api-auth.ts\");\n/* harmony import */ var _lib_audit__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/lib/audit */ \"(rsc)/./lib/audit.ts\");\n/* harmony import */ var _lib_validation__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/lib/validation */ \"(rsc)/./lib/validation.ts\");\n/* harmony import */ var next_cache__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! next/cache */ \"(rsc)/./node_modules/next/cache.js\");\n/* harmony import */ var next_cache__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(next_cache__WEBPACK_IMPORTED_MODULE_7__);\n\n\n\n\n\n\n\n\nfunction coerceOptionalId(value) {\n    if (typeof value !== \"string\") {\n        return null;\n    }\n    const trimmed = value.trim();\n    return trimmed.length > 0 ? trimmed : null;\n}\nfunction parseAddress(raw) {\n    if (!raw || typeof raw !== \"object\") {\n        return null;\n    }\n    const candidate = raw;\n    const line1 = typeof candidate.line1 === \"string\" ? candidate.line1.trim() : \"\";\n    const city = typeof candidate.city === \"string\" ? candidate.city.trim() : \"\";\n    if (!line1 || !city) {\n        return null;\n    }\n    const line2 = typeof candidate.line2 === \"string\" ? candidate.line2.trim() : \"\";\n    const state = typeof candidate.state === \"string\" ? candidate.state.trim() : \"\";\n    const postalCode = typeof candidate.postalCode === \"string\" ? candidate.postalCode.trim() : \"\";\n    const country = typeof candidate.country === \"string\" ? candidate.country.trim() : \"\";\n    return {\n        line1,\n        city,\n        line2: line2 || undefined,\n        state: state || undefined,\n        postalCode: postalCode || undefined,\n        country: country || undefined\n    };\n}\nasync function createAddressRecord(tenantId, input) {\n    if (!input) {\n        return null;\n    }\n    const address = await _lib_db__WEBPACK_IMPORTED_MODULE_2__.prisma.address.create({\n        data: {\n            tenantId,\n            line1: input.line1,\n            line2: input.line2 ?? null,\n            city: input.city,\n            state: input.state ?? null,\n            postalCode: input.postalCode ?? null,\n            country: input.country ?? null\n        }\n    });\n    return address.id;\n}\nasync function GET(request) {\n    return (0,_lib_api_auth__WEBPACK_IMPORTED_MODULE_4__.withPermissions)(request, [\n        \"accounts.manage\",\n        \"accounts.read\"\n    ], async (req)=>{\n        try {\n            const searchParams = request.nextUrl.searchParams;\n            const tenantId = req.user.tenantId;\n            const page = Number(searchParams.get(\"page\") ?? \"1\");\n            const pageSize = Number(searchParams.get(\"pageSize\") ?? \"25\");\n            const query = searchParams.get(\"q\")?.trim() ?? \"\";\n            const whereClause = {\n                tenantId\n            };\n            if (query.length > 0) {\n                whereClause.OR = [\n                    {\n                        accountName: {\n                            contains: query,\n                            mode: \"insensitive\"\n                        }\n                    },\n                    {\n                        accountLegalName: {\n                            contains: query,\n                            mode: \"insensitive\"\n                        }\n                    },\n                    {\n                        owner: {\n                            is: {\n                                fullName: {\n                                    contains: query,\n                                    mode: \"insensitive\"\n                                }\n                            }\n                        }\n                    }\n                ];\n            }\n            const [accounts, total] = await Promise.all([\n                _lib_db__WEBPACK_IMPORTED_MODULE_2__.prisma.account.findMany({\n                    where: whereClause,\n                    include: _helpers__WEBPACK_IMPORTED_MODULE_3__.accountIncludeForList,\n                    orderBy: {\n                        createdAt: \"desc\"\n                    },\n                    skip: (page - 1) * pageSize,\n                    take: pageSize\n                }),\n                _lib_db__WEBPACK_IMPORTED_MODULE_2__.prisma.account.count({\n                    where: whereClause\n                })\n            ]);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                data: accounts.map(_helpers__WEBPACK_IMPORTED_MODULE_3__.mapAccountToListRow),\n                pagination: {\n                    page,\n                    pageSize,\n                    total\n                }\n            });\n        } catch (error) {\n            console.error(\"Failed to load accounts\", error);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Failed to load accounts\"\n            }, {\n                status: 500\n            });\n        }\n    });\n}\nasync function POST(request) {\n    return (0,_lib_api_auth__WEBPACK_IMPORTED_MODULE_4__.withPermissions)(request, [\n        \"accounts.manage\"\n    ], async (req)=>{\n        try {\n            const payload = await request.json();\n            // Validate account data according to contract requirements\n            const validationResult = (0,_lib_validation__WEBPACK_IMPORTED_MODULE_6__.validateAccountData)(payload);\n            if (!validationResult.isValid) {\n                return (0,_lib_validation__WEBPACK_IMPORTED_MODULE_6__.createValidationErrorResponse)(validationResult.errors);\n            }\n            const accountName = typeof payload.accountName === \"string\" ? payload.accountName.trim() : \"\";\n            const accountTypeId = coerceOptionalId(payload.accountTypeId);\n            const tenantId = req.user.tenantId;\n            const userId = req.user.id;\n            if (accountTypeId) {\n                const accountTypeExists = await _lib_db__WEBPACK_IMPORTED_MODULE_2__.prisma.accountType.findFirst({\n                    where: {\n                        id: accountTypeId,\n                        tenantId\n                    },\n                    select: {\n                        id: true\n                    }\n                });\n                if (!accountTypeExists) {\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        error: \"Invalid account type\"\n                    }, {\n                        status: 400\n                    });\n                }\n            }\n            const parentAccountId = coerceOptionalId(payload.parentAccountId);\n            const ownerId = coerceOptionalId(payload.ownerId);\n            const industryId = coerceOptionalId(payload.industryId);\n            const isActive = typeof payload.active === \"boolean\" ? payload.active : true;\n            const syncBillingWithShipping = Boolean(payload.syncBillingWithShipping ?? payload.billingSameAsShipping);\n            const shippingAddressInput = parseAddress(payload.shippingAddress);\n            const billingAddressInput = syncBillingWithShipping ? shippingAddressInput : parseAddress(payload.billingAddress);\n            const [shippingAddressId, billingAddressIdIfAny] = await Promise.all([\n                createAddressRecord(tenantId, shippingAddressInput),\n                syncBillingWithShipping ? Promise.resolve(null) : createAddressRecord(tenantId, billingAddressInput)\n            ]);\n            const billingAddressId = syncBillingWithShipping ? shippingAddressId : billingAddressIdIfAny;\n            const account = await _lib_db__WEBPACK_IMPORTED_MODULE_2__.prisma.account.create({\n                data: {\n                    tenantId,\n                    accountTypeId: accountTypeId,\n                    ...parentAccountId && {\n                        parentAccountId\n                    },\n                    ...ownerId && {\n                        ownerId\n                    },\n                    ...industryId && {\n                        industryId\n                    },\n                    accountName,\n                    accountLegalName: typeof payload.accountLegalName === \"string\" && payload.accountLegalName.trim().length > 0 ? payload.accountLegalName.trim() : null,\n                    status: isActive ? _prisma_client__WEBPACK_IMPORTED_MODULE_1__.AccountStatus.Active : _prisma_client__WEBPACK_IMPORTED_MODULE_1__.AccountStatus.Inactive,\n                    websiteUrl: typeof payload.websiteUrl === \"string\" && payload.websiteUrl.trim().length > 0 ? payload.websiteUrl.trim() : null,\n                    description: typeof payload.description === \"string\" && payload.description.trim().length > 0 ? payload.description.trim() : null,\n                    shippingAddressId,\n                    billingAddressId,\n                    shippingSyncBilling: syncBillingWithShipping,\n                    createdById: userId,\n                    updatedById: userId\n                },\n                include: _helpers__WEBPACK_IMPORTED_MODULE_3__.accountIncludeForList\n            });\n            // Log audit event for account creation\n            await (0,_lib_audit__WEBPACK_IMPORTED_MODULE_5__.logAccountAudit)(_prisma_client__WEBPACK_IMPORTED_MODULE_1__.AuditAction.Create, account.id, userId, tenantId, request, undefined, {\n                accountName: account.accountName,\n                accountLegalName: account.accountLegalName,\n                accountTypeId: account.accountTypeId,\n                status: account.status,\n                websiteUrl: account.websiteUrl,\n                description: account.description\n            });\n            // Invalidate cache to ensure UI updates immediately\n            (0,next_cache__WEBPACK_IMPORTED_MODULE_7__.revalidatePath)(\"/accounts\");\n            (0,next_cache__WEBPACK_IMPORTED_MODULE_7__.revalidatePath)(\"/dashboard\");\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                data: (0,_helpers__WEBPACK_IMPORTED_MODULE_3__.mapAccountToListRow)(account)\n            }, {\n                status: 201\n            });\n        } catch (error) {\n            console.error(\"Failed to create account\", error);\n            const message = error?.message ?? \"Failed to create account\";\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: message\n            }, {\n                status: 500\n            });\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dkMsTUFBTUUsMkRBQWVBLENBQ25CTCx1REFBV0EsQ0FBQ3dHLE1BQU0sRUFDbEJqRCxRQUFRekIsRUFBRSxFQUNWOEMsUUFDQW5ELFVBQ0FPLFNBQ0FULFdBQ0E7Z0JBQ0VxQixhQUFhVyxRQUFRWCxXQUFXO2dCQUNoQ0csa0JBQWtCUSxRQUFRUixnQkFBZ0I7Z0JBQzFDNEIsZUFBZXBCLFFBQVFvQixhQUFhO2dCQUNwQ04sUUFBUWQsUUFBUWMsTUFBTTtnQkFDdEI4QixZQUFZNUMsUUFBUTRDLFVBQVU7Z0JBQzlCQyxhQUFhN0MsUUFBUTZDLFdBQVc7WUFDbEM7WUFHRixvREFBb0Q7WUFDcEQ1RiwwREFBY0EsQ0FBQztZQUNmQSwwREFBY0EsQ0FBQztZQUVmLE9BQU9WLHFEQUFZQSxDQUFDa0UsSUFBSSxDQUFDO2dCQUFFbkMsTUFBTTNCLDZEQUFtQkEsQ0FBQ3FEO1lBQVMsR0FBRztnQkFBRWMsUUFBUTtZQUFJO1FBQ2pGLEVBQUUsT0FBT0YsT0FBWTtZQUNuQkMsUUFBUUQsS0FBSyxDQUFDLDRCQUE0QkE7WUFDMUMsTUFBTXNDLFVBQVV0QyxPQUFPc0MsV0FBVztZQUNsQyxPQUFPM0cscURBQVlBLENBQUNrRSxJQUFJLENBQUM7Z0JBQUVHLE9BQU9zQztZQUFRLEdBQUc7Z0JBQUVwQyxRQUFRO1lBQUk7UUFDN0Q7SUFDRjtBQUVKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY29tbWlzc2FibGUtY3JtLy4vYXBwL2FwaS9hY2NvdW50cy9yb3V0ZS50cz8xYTFiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIlxuaW1wb3J0IHsgQWNjb3VudFN0YXR1cywgQXVkaXRBY3Rpb24gfSBmcm9tIFwiQHByaXNtYS9jbGllbnRcIlxuaW1wb3J0IHsgcHJpc21hIH0gZnJvbSBcIkAvbGliL2RiXCJcbmltcG9ydCB7IG1hcEFjY291bnRUb0xpc3RSb3csIGFjY291bnRJbmNsdWRlRm9yTGlzdCB9IGZyb20gXCIuL2hlbHBlcnNcIlxuaW1wb3J0IHsgd2l0aFBlcm1pc3Npb25zLCBjcmVhdGVFcnJvclJlc3BvbnNlIH0gZnJvbSBcIkAvbGliL2FwaS1hdXRoXCJcbmltcG9ydCB7IGxvZ0FjY291bnRBdWRpdCB9IGZyb20gXCJAL2xpYi9hdWRpdFwiXG5pbXBvcnQgeyB2YWxpZGF0ZUFjY291bnREYXRhLCBjcmVhdGVWYWxpZGF0aW9uRXJyb3JSZXNwb25zZSwgbm9ybWFsaXplRW1haWwsIG5vcm1hbGl6ZVN0YXRlLCBmb3JtYXRQaG9uZU51bWJlciB9IGZyb20gXCJAL2xpYi92YWxpZGF0aW9uXCJcbmltcG9ydCB7IHJldmFsaWRhdGVQYXRoIH0gZnJvbSBcIm5leHQvY2FjaGVcIlxuXG50eXBlIEFkZHJlc3NJbnB1dCA9IHtcbiAgbGluZTE6IHN0cmluZ1xuICBjaXR5OiBzdHJpbmdcbiAgbGluZTI/OiBzdHJpbmdcbiAgc3RhdGU/OiBzdHJpbmdcbiAgcG9zdGFsQ29kZT86IHN0cmluZ1xuICBjb3VudHJ5Pzogc3RyaW5nXG59XG5cbmZ1bmN0aW9uIGNvZXJjZU9wdGlvbmFsSWQodmFsdWU6IHVua25vd24pOiBzdHJpbmcgfCBudWxsIHtcbiAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gXCJzdHJpbmdcIikge1xuICAgIHJldHVybiBudWxsXG4gIH1cblxuICBjb25zdCB0cmltbWVkID0gdmFsdWUudHJpbSgpXG4gIHJldHVybiB0cmltbWVkLmxlbmd0aCA+IDAgPyB0cmltbWVkIDogbnVsbFxufVxuXG5mdW5jdGlvbiBwYXJzZUFkZHJlc3MocmF3OiB1bmtub3duKTogQWRkcmVzc0lucHV0IHwgbnVsbCB7XG4gIGlmICghcmF3IHx8IHR5cGVvZiByYXcgIT09IFwib2JqZWN0XCIpIHtcbiAgICByZXR1cm4gbnVsbFxuICB9XG5cbiAgY29uc3QgY2FuZGlkYXRlID0gcmF3IGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+XG4gIGNvbnN0IGxpbmUxID0gdHlwZW9mIGNhbmRpZGF0ZS5saW5lMSA9PT0gXCJzdHJpbmdcIiA/IGNhbmRpZGF0ZS5saW5lMS50cmltKCkgOiBcIlwiXG4gIGNvbnN0IGNpdHkgPSB0eXBlb2YgY2FuZGlkYXRlLmNpdHkgPT09IFwic3RyaW5nXCIgPyBjYW5kaWRhdGUuY2l0eS50cmltKCkgOiBcIlwiXG5cbiAgaWYgKCFsaW5lMSB8fCAhY2l0eSkge1xuICAgIHJldHVybiBudWxsXG4gIH1cblxuICBjb25zdCBsaW5lMiA9IHR5cGVvZiBjYW5kaWRhdGUubGluZTIgPT09IFwic3RyaW5nXCIgPyBjYW5kaWRhdGUubGluZTIudHJpbSgpIDogXCJcIlxuICBjb25zdCBzdGF0ZSA9IHR5cGVvZiBjYW5kaWRhdGUuc3RhdGUgPT09IFwic3RyaW5nXCIgPyBjYW5kaWRhdGUuc3RhdGUudHJpbSgpIDogXCJcIlxuICBjb25zdCBwb3N0YWxDb2RlID0gdHlwZW9mIGNhbmRpZGF0ZS5wb3N0YWxDb2RlID09PSBcInN0cmluZ1wiID8gY2FuZGlkYXRlLnBvc3RhbENvZGUudHJpbSgpIDogXCJcIlxuICBjb25zdCBjb3VudHJ5ID0gdHlwZW9mIGNhbmRpZGF0ZS5jb3VudHJ5ID09PSBcInN0cmluZ1wiID8gY2FuZGlkYXRlLmNvdW50cnkudHJpbSgpIDogXCJcIlxuXG4gIHJldHVybiB7XG4gICAgbGluZTEsXG4gICAgY2l0eSxcbiAgICBsaW5lMjogbGluZTIgfHwgdW5kZWZpbmVkLFxuICAgIHN0YXRlOiBzdGF0ZSB8fCB1bmRlZmluZWQsXG4gICAgcG9zdGFsQ29kZTogcG9zdGFsQ29kZSB8fCB1bmRlZmluZWQsXG4gICAgY291bnRyeTogY291bnRyeSB8fCB1bmRlZmluZWRcbiAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBjcmVhdGVBZGRyZXNzUmVjb3JkKHRlbmFudElkOiBzdHJpbmcsIGlucHV0OiBBZGRyZXNzSW5wdXQgfCBudWxsKSB7XG4gIGlmICghaW5wdXQpIHtcbiAgICByZXR1cm4gbnVsbFxuICB9XG5cbiAgY29uc3QgYWRkcmVzcyA9IGF3YWl0IHByaXNtYS5hZGRyZXNzLmNyZWF0ZSh7XG4gICAgZGF0YToge1xuICAgICAgdGVuYW50SWQsXG4gICAgICBsaW5lMTogaW5wdXQubGluZTEsXG4gICAgICBsaW5lMjogaW5wdXQubGluZTIgPz8gbnVsbCxcbiAgICAgIGNpdHk6IGlucHV0LmNpdHksXG4gICAgICBzdGF0ZTogaW5wdXQuc3RhdGUgPz8gbnVsbCxcbiAgICAgIHBvc3RhbENvZGU6IGlucHV0LnBvc3RhbENvZGUgPz8gbnVsbCxcbiAgICAgIGNvdW50cnk6IGlucHV0LmNvdW50cnkgPz8gbnVsbFxuICAgIH1cbiAgfSlcblxuICByZXR1cm4gYWRkcmVzcy5pZFxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIHJldHVybiB3aXRoUGVybWlzc2lvbnMoXG4gICAgcmVxdWVzdCxcbiAgICBbJ2FjY291bnRzLm1hbmFnZScsICdhY2NvdW50cy5yZWFkJ10sXG4gICAgYXN5bmMgKHJlcSkgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3Qgc2VhcmNoUGFyYW1zID0gcmVxdWVzdC5uZXh0VXJsLnNlYXJjaFBhcmFtc1xuICAgICAgICBjb25zdCB0ZW5hbnRJZCA9IHJlcS51c2VyLnRlbmFudElkXG5cbiAgICAgICAgY29uc3QgcGFnZSA9IE51bWJlcihzZWFyY2hQYXJhbXMuZ2V0KFwicGFnZVwiKSA/PyBcIjFcIilcbiAgICAgICAgY29uc3QgcGFnZVNpemUgPSBOdW1iZXIoc2VhcmNoUGFyYW1zLmdldChcInBhZ2VTaXplXCIpID8/IFwiMjVcIilcbiAgICAgICAgY29uc3QgcXVlcnkgPSBzZWFyY2hQYXJhbXMuZ2V0KFwicVwiKT8udHJpbSgpID8/IFwiXCJcblxuICAgICAgICBjb25zdCB3aGVyZUNsYXVzZTogUmVjb3JkPHN0cmluZywgdW5rbm93bj4gPSB7IHRlbmFudElkIH1cblxuICAgICAgICBpZiAocXVlcnkubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHdoZXJlQ2xhdXNlLk9SID0gW1xuICAgICAgICAgICAgeyBhY2NvdW50TmFtZTogeyBjb250YWluczogcXVlcnksIG1vZGU6IFwiaW5zZW5zaXRpdmVcIiB9IH0sXG4gICAgICAgICAgICB7IGFjY291bnRMZWdhbE5hbWU6IHsgY29udGFpbnM6IHF1ZXJ5LCBtb2RlOiBcImluc2Vuc2l0aXZlXCIgfSB9LFxuICAgICAgICAgICAgeyBvd25lcjogeyBpczogeyBmdWxsTmFtZTogeyBjb250YWluczogcXVlcnksIG1vZGU6IFwiaW5zZW5zaXRpdmVcIiB9IH0gfSB9XG4gICAgICAgICAgXVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgW2FjY291bnRzLCB0b3RhbF0gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICAgICAgcHJpc21hLmFjY291bnQuZmluZE1hbnkoe1xuICAgICAgICAgICAgd2hlcmU6IHdoZXJlQ2xhdXNlLFxuICAgICAgICAgICAgaW5jbHVkZTogYWNjb3VudEluY2x1ZGVGb3JMaXN0LFxuICAgICAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6IFwiZGVzY1wiIH0sXG4gICAgICAgICAgICBza2lwOiAocGFnZSAtIDEpICogcGFnZVNpemUsXG4gICAgICAgICAgICB0YWtlOiBwYWdlU2l6ZVxuICAgICAgICAgIH0pLFxuICAgICAgICAgIHByaXNtYS5hY2NvdW50LmNvdW50KHsgd2hlcmU6IHdoZXJlQ2xhdXNlIH0pXG4gICAgICAgIF0pXG5cbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgICBkYXRhOiBhY2NvdW50cy5tYXAobWFwQWNjb3VudFRvTGlzdFJvdyksXG4gICAgICAgICAgcGFnaW5hdGlvbjoge1xuICAgICAgICAgICAgcGFnZSxcbiAgICAgICAgICAgIHBhZ2VTaXplLFxuICAgICAgICAgICAgdG90YWxcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGxvYWQgYWNjb3VudHNcIiwgZXJyb3IpXG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBcIkZhaWxlZCB0byBsb2FkIGFjY291bnRzXCIgfSwgeyBzdGF0dXM6IDUwMCB9KVxuICAgICAgfVxuICAgIH1cbiAgKVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICByZXR1cm4gd2l0aFBlcm1pc3Npb25zKFxuICAgIHJlcXVlc3QsXG4gICAgWydhY2NvdW50cy5tYW5hZ2UnXSxcbiAgICBhc3luYyAocmVxKSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBwYXlsb2FkID0gYXdhaXQgcmVxdWVzdC5qc29uKClcbiAgICAgICAgXG4gICAgICAgIC8vIFZhbGlkYXRlIGFjY291bnQgZGF0YSBhY2NvcmRpbmcgdG8gY29udHJhY3QgcmVxdWlyZW1lbnRzXG4gICAgICAgIGNvbnN0IHZhbGlkYXRpb25SZXN1bHQgPSB2YWxpZGF0ZUFjY291bnREYXRhKHBheWxvYWQpXG4gICAgICAgIGlmICghdmFsaWRhdGlvblJlc3VsdC5pc1ZhbGlkKSB7XG4gICAgICAgICAgcmV0dXJuIGNyZWF0ZVZhbGlkYXRpb25FcnJvclJlc3BvbnNlKHZhbGlkYXRpb25SZXN1bHQuZXJyb3JzKVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBjb25zdCBhY2NvdW50TmFtZSA9IHR5cGVvZiBwYXlsb2FkLmFjY291bnROYW1lID09PSBcInN0cmluZ1wiID8gcGF5bG9hZC5hY2NvdW50TmFtZS50cmltKCkgOiBcIlwiXG4gICAgICAgIGNvbnN0IGFjY291bnRUeXBlSWQgPSBjb2VyY2VPcHRpb25hbElkKHBheWxvYWQuYWNjb3VudFR5cGVJZClcblxuICAgICAgICBjb25zdCB0ZW5hbnRJZCA9IHJlcS51c2VyLnRlbmFudElkXG4gICAgICAgIGNvbnN0IHVzZXJJZCA9IHJlcS51c2VyLmlkXG5cbiAgICBpZiAoYWNjb3VudFR5cGVJZCkge1xuICAgICAgY29uc3QgYWNjb3VudFR5cGVFeGlzdHMgPSBhd2FpdCBwcmlzbWEuYWNjb3VudFR5cGUuZmluZEZpcnN0KHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IGFjY291bnRUeXBlSWQsIHRlbmFudElkIH0sXG4gICAgICAgIHNlbGVjdDogeyBpZDogdHJ1ZSB9XG4gICAgICB9KVxuXG4gICAgICBpZiAoIWFjY291bnRUeXBlRXhpc3RzKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBcIkludmFsaWQgYWNjb3VudCB0eXBlXCIgfSwgeyBzdGF0dXM6IDQwMCB9KVxuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IHBhcmVudEFjY291bnRJZCA9IGNvZXJjZU9wdGlvbmFsSWQocGF5bG9hZC5wYXJlbnRBY2NvdW50SWQpXG4gICAgY29uc3Qgb3duZXJJZCA9IGNvZXJjZU9wdGlvbmFsSWQocGF5bG9hZC5vd25lcklkKVxuICAgIGNvbnN0IGluZHVzdHJ5SWQgPSBjb2VyY2VPcHRpb25hbElkKHBheWxvYWQuaW5kdXN0cnlJZClcblxuICAgIGNvbnN0IGlzQWN0aXZlID0gdHlwZW9mIHBheWxvYWQuYWN0aXZlID09PSBcImJvb2xlYW5cIiA/IHBheWxvYWQuYWN0aXZlIDogdHJ1ZVxuICAgIGNvbnN0IHN5bmNCaWxsaW5nV2l0aFNoaXBwaW5nID0gQm9vbGVhbihcbiAgICAgIHBheWxvYWQuc3luY0JpbGxpbmdXaXRoU2hpcHBpbmcgPz8gcGF5bG9hZC5iaWxsaW5nU2FtZUFzU2hpcHBpbmdcbiAgICApXG5cbiAgICBjb25zdCBzaGlwcGluZ0FkZHJlc3NJbnB1dCA9IHBhcnNlQWRkcmVzcyhwYXlsb2FkLnNoaXBwaW5nQWRkcmVzcylcbiAgICBjb25zdCBiaWxsaW5nQWRkcmVzc0lucHV0ID0gc3luY0JpbGxpbmdXaXRoU2hpcHBpbmdcbiAgICAgID8gc2hpcHBpbmdBZGRyZXNzSW5wdXRcbiAgICAgIDogcGFyc2VBZGRyZXNzKHBheWxvYWQuYmlsbGluZ0FkZHJlc3MpXG5cbiAgICBjb25zdCBbc2hpcHBpbmdBZGRyZXNzSWQsIGJpbGxpbmdBZGRyZXNzSWRJZkFueV0gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICBjcmVhdGVBZGRyZXNzUmVjb3JkKHRlbmFudElkLCBzaGlwcGluZ0FkZHJlc3NJbnB1dCksXG4gICAgICBzeW5jQmlsbGluZ1dpdGhTaGlwcGluZ1xuICAgICAgICA/IFByb21pc2UucmVzb2x2ZTxzdHJpbmcgfCBudWxsPihudWxsKVxuICAgICAgICA6IGNyZWF0ZUFkZHJlc3NSZWNvcmQodGVuYW50SWQsIGJpbGxpbmdBZGRyZXNzSW5wdXQpXG4gICAgXSlcblxuICAgIGNvbnN0IGJpbGxpbmdBZGRyZXNzSWQgPSBzeW5jQmlsbGluZ1dpdGhTaGlwcGluZyA/IHNoaXBwaW5nQWRkcmVzc0lkIDogYmlsbGluZ0FkZHJlc3NJZElmQW55XG5cbiAgICBjb25zdCBhY2NvdW50ID0gYXdhaXQgcHJpc21hLmFjY291bnQuY3JlYXRlKHtcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgdGVuYW50SWQsXG4gICAgICAgIGFjY291bnRUeXBlSWQ6IGFjY291bnRUeXBlSWQhLFxuICAgICAgICAuLi4ocGFyZW50QWNjb3VudElkICYmIHsgcGFyZW50QWNjb3VudElkIH0pLFxuICAgICAgICAuLi4ob3duZXJJZCAmJiB7IG93bmVySWQgfSksXG4gICAgICAgIC4uLihpbmR1c3RyeUlkICYmIHsgaW5kdXN0cnlJZCB9KSxcbiAgICAgICAgYWNjb3VudE5hbWUsXG4gICAgICAgIGFjY291bnRMZWdhbE5hbWU6XG4gICAgICAgICAgdHlwZW9mIHBheWxvYWQuYWNjb3VudExlZ2FsTmFtZSA9PT0gXCJzdHJpbmdcIiAmJiBwYXlsb2FkLmFjY291bnRMZWdhbE5hbWUudHJpbSgpLmxlbmd0aCA+IDBcbiAgICAgICAgICAgID8gcGF5bG9hZC5hY2NvdW50TGVnYWxOYW1lLnRyaW0oKVxuICAgICAgICAgICAgOiBudWxsLFxuICAgICAgICBzdGF0dXM6IGlzQWN0aXZlID8gQWNjb3VudFN0YXR1cy5BY3RpdmUgOiBBY2NvdW50U3RhdHVzLkluYWN0aXZlLFxuICAgICAgICB3ZWJzaXRlVXJsOlxuICAgICAgICAgIHR5cGVvZiBwYXlsb2FkLndlYnNpdGVVcmwgPT09IFwic3RyaW5nXCIgJiYgcGF5bG9hZC53ZWJzaXRlVXJsLnRyaW0oKS5sZW5ndGggPiAwXG4gICAgICAgICAgICA/IHBheWxvYWQud2Vic2l0ZVVybC50cmltKClcbiAgICAgICAgICAgIDogbnVsbCxcbiAgICAgICAgZGVzY3JpcHRpb246XG4gICAgICAgICAgdHlwZW9mIHBheWxvYWQuZGVzY3JpcHRpb24gPT09IFwic3RyaW5nXCIgJiYgcGF5bG9hZC5kZXNjcmlwdGlvbi50cmltKCkubGVuZ3RoID4gMFxuICAgICAgICAgICAgPyBwYXlsb2FkLmRlc2NyaXB0aW9uLnRyaW0oKVxuICAgICAgICAgICAgOiBudWxsLFxuICAgICAgICBzaGlwcGluZ0FkZHJlc3NJZCxcbiAgICAgICAgYmlsbGluZ0FkZHJlc3NJZCxcbiAgICAgICAgc2hpcHBpbmdTeW5jQmlsbGluZzogc3luY0JpbGxpbmdXaXRoU2hpcHBpbmcsXG4gICAgICAgIGNyZWF0ZWRCeUlkOiB1c2VySWQsXG4gICAgICAgIHVwZGF0ZWRCeUlkOiB1c2VySWRcbiAgICAgIH0sXG4gICAgICBpbmNsdWRlOiBhY2NvdW50SW5jbHVkZUZvckxpc3RcbiAgICB9KVxuXG4gICAgICAgIC8vIExvZyBhdWRpdCBldmVudCBmb3IgYWNjb3VudCBjcmVhdGlvblxuICAgICAgICBhd2FpdCBsb2dBY2NvdW50QXVkaXQoXG4gICAgICAgICAgQXVkaXRBY3Rpb24uQ3JlYXRlLFxuICAgICAgICAgIGFjY291bnQuaWQsXG4gICAgICAgICAgdXNlcklkLFxuICAgICAgICAgIHRlbmFudElkLFxuICAgICAgICAgIHJlcXVlc3QsXG4gICAgICAgICAgdW5kZWZpbmVkLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGFjY291bnROYW1lOiBhY2NvdW50LmFjY291bnROYW1lLFxuICAgICAgICAgICAgYWNjb3VudExlZ2FsTmFtZTogYWNjb3VudC5hY2NvdW50TGVnYWxOYW1lLFxuICAgICAgICAgICAgYWNjb3VudFR5cGVJZDogYWNjb3VudC5hY2NvdW50VHlwZUlkLFxuICAgICAgICAgICAgc3RhdHVzOiBhY2NvdW50LnN0YXR1cyxcbiAgICAgICAgICAgIHdlYnNpdGVVcmw6IGFjY291bnQud2Vic2l0ZVVybCxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBhY2NvdW50LmRlc2NyaXB0aW9uXG4gICAgICAgICAgfVxuICAgICAgICApXG5cbiAgICAgICAgLy8gSW52YWxpZGF0ZSBjYWNoZSB0byBlbnN1cmUgVUkgdXBkYXRlcyBpbW1lZGlhdGVseVxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2FjY291bnRzJylcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9kYXNoYm9hcmQnKVxuXG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGRhdGE6IG1hcEFjY291bnRUb0xpc3RSb3coYWNjb3VudCkgfSwgeyBzdGF0dXM6IDIwMSB9KVxuICAgICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGNyZWF0ZSBhY2NvdW50XCIsIGVycm9yKVxuICAgICAgICBjb25zdCBtZXNzYWdlID0gZXJyb3I/Lm1lc3NhZ2UgPz8gXCJGYWlsZWQgdG8gY3JlYXRlIGFjY291bnRcIlxuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogbWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pXG4gICAgICB9XG4gICAgfVxuICApXG59XG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiQWNjb3VudFN0YXR1cyIsIkF1ZGl0QWN0aW9uIiwicHJpc21hIiwibWFwQWNjb3VudFRvTGlzdFJvdyIsImFjY291bnRJbmNsdWRlRm9yTGlzdCIsIndpdGhQZXJtaXNzaW9ucyIsImxvZ0FjY291bnRBdWRpdCIsInZhbGlkYXRlQWNjb3VudERhdGEiLCJjcmVhdGVWYWxpZGF0aW9uRXJyb3JSZXNwb25zZSIsInJldmFsaWRhdGVQYXRoIiwiY29lcmNlT3B0aW9uYWxJZCIsInZhbHVlIiwidHJpbW1lZCIsInRyaW0iLCJsZW5ndGgiLCJwYXJzZUFkZHJlc3MiLCJyYXciLCJjYW5kaWRhdGUiLCJsaW5lMSIsImNpdHkiLCJsaW5lMiIsInN0YXRlIiwicG9zdGFsQ29kZSIsImNvdW50cnkiLCJ1bmRlZmluZWQiLCJjcmVhdGVBZGRyZXNzUmVjb3JkIiwidGVuYW50SWQiLCJpbnB1dCIsImFkZHJlc3MiLCJjcmVhdGUiLCJkYXRhIiwiaWQiLCJHRVQiLCJyZXF1ZXN0IiwicmVxIiwic2VhcmNoUGFyYW1zIiwibmV4dFVybCIsInVzZXIiLCJwYWdlIiwiTnVtYmVyIiwiZ2V0IiwicGFnZVNpemUiLCJxdWVyeSIsIndoZXJlQ2xhdXNlIiwiT1IiLCJhY2NvdW50TmFtZSIsImNvbnRhaW5zIiwibW9kZSIsImFjY291bnRMZWdhbE5hbWUiLCJvd25lciIsImlzIiwiZnVsbE5hbWUiLCJhY2NvdW50cyIsInRvdGFsIiwiUHJvbWlzZSIsImFsbCIsImFjY291bnQiLCJmaW5kTWFueSIsIndoZXJlIiwiaW5jbHVkZSIsIm9yZGVyQnkiLCJjcmVhdGVkQXQiLCJza2lwIiwidGFrZSIsImNvdW50IiwianNvbiIsIm1hcCIsInBhZ2luYXRpb24iLCJlcnJvciIsImNvbnNvbGUiLCJzdGF0dXMiLCJQT1NUIiwicGF5bG9hZCIsInZhbGlkYXRpb25SZXN1bHQiLCJpc1ZhbGlkIiwiZXJyb3JzIiwiYWNjb3VudFR5cGVJZCIsInVzZXJJZCIsImFjY291bnRUeXBlRXhpc3RzIiwiYWNjb3VudFR5cGUiLCJmaW5kRmlyc3QiLCJzZWxlY3QiLCJwYXJlbnRBY2NvdW50SWQiLCJvd25lcklkIiwiaW5kdXN0cnlJZCIsImlzQWN0aXZlIiwiYWN0aXZlIiwic3luY0JpbGxpbmdXaXRoU2hpcHBpbmciLCJCb29sZWFuIiwiYmlsbGluZ1NhbWVBc1NoaXBwaW5nIiwic2hpcHBpbmdBZGRyZXNzSW5wdXQiLCJzaGlwcGluZ0FkZHJlc3MiLCJiaWxsaW5nQWRkcmVzc0lucHV0IiwiYmlsbGluZ0FkZHJlc3MiLCJzaGlwcGluZ0FkZHJlc3NJZCIsImJpbGxpbmdBZGRyZXNzSWRJZkFueSIsInJlc29sdmUiLCJiaWxsaW5nQWRkcmVzc0lkIiwiQWN0aXZlIiwiSW5hY3RpdmUiLCJ3ZWJzaXRlVXJsIiwiZGVzY3JpcHRpb24iLCJzaGlwcGluZ1N5bmNCaWxsaW5nIiwiY3JlYXRlZEJ5SWQiLCJ1cGRhdGVkQnlJZCIsIkNyZWF0ZSIsIm1lc3NhZ2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/accounts/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/api-auth.ts":
/*!*************************!*\
  !*** ./lib/api-auth.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createApiResponse: () => (/* binding */ createApiResponse),\n/* harmony export */   createErrorResponse: () => (/* binding */ createErrorResponse),\n/* harmony export */   withAuth: () => (/* binding */ withAuth),\n/* harmony export */   withPermissions: () => (/* binding */ withPermissions),\n/* harmony export */   withRole: () => (/* binding */ withRole)\n/* harmony export */ });\n/* harmony import */ var _auth__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./auth */ \"(rsc)/./lib/auth.ts\");\n\nasync function withAuth(request, handler) {\n    try {\n        // Get authenticated user\n        const user = await (0,_auth__WEBPACK_IMPORTED_MODULE_0__.getAuthenticatedUser)();\n        if (!user) {\n            return new Response(JSON.stringify({\n                error: \"Authentication required\"\n            }), {\n                status: 401,\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                }\n            });\n        }\n        // Add user to request object\n        const authenticatedRequest = request;\n        authenticatedRequest.user = user;\n        // Call the handler\n        const result = await handler(authenticatedRequest);\n        // If result is already a Response, return it\n        if (result instanceof Response) {\n            return result;\n        }\n        // Otherwise, wrap in Response\n        return new Response(JSON.stringify(result), {\n            status: 200,\n            headers: {\n                \"Content-Type\": \"application/json\"\n            }\n        });\n    } catch (error) {\n        console.error(\"API error:\", error);\n        return new Response(JSON.stringify({\n            error: \"Internal server error\"\n        }), {\n            status: 500,\n            headers: {\n                \"Content-Type\": \"application/json\"\n            }\n        });\n    }\n}\nasync function withPermissions(request, permissions, handler, options = {}) {\n    const { requireAll = false } = options;\n    return withAuth(request, async (authenticatedRequest)=>{\n        const { user } = authenticatedRequest;\n        // Check permissions\n        const hasRequiredPermissions = requireAll ? (0,_auth__WEBPACK_IMPORTED_MODULE_0__.hasAllPermissions)(user, permissions) : (0,_auth__WEBPACK_IMPORTED_MODULE_0__.hasAnyPermission)(user, permissions);\n        if (!hasRequiredPermissions) {\n            return new Response(JSON.stringify({\n                error: \"Insufficient permissions\",\n                required: permissions,\n                requireAll\n            }), {\n                status: 403,\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                }\n            });\n        }\n        return handler(authenticatedRequest);\n    });\n}\nasync function withRole(request, roles, handler) {\n    return withAuth(request, async (authenticatedRequest)=>{\n        const { user } = authenticatedRequest;\n        // Check role\n        if (!user.role || !roles.includes(user.role.code)) {\n            return new Response(JSON.stringify({\n                error: \"Insufficient role access\",\n                required: roles,\n                current: user.role?.code || null\n            }), {\n                status: 403,\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                }\n            });\n        }\n        return handler(authenticatedRequest);\n    });\n}\nfunction createApiResponse(data, status = 200, message) {\n    const response = {\n        data\n    };\n    if (message) response.message = message;\n    return new Response(JSON.stringify(response), {\n        status,\n        headers: {\n            \"Content-Type\": \"application/json\"\n        }\n    });\n}\nfunction createErrorResponse(error, status = 400) {\n    return new Response(JSON.stringify({\n        error\n    }), {\n        status,\n        headers: {\n            \"Content-Type\": \"application/json\"\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RU8sU0FBU29CLG9CQUNkdEIsS0FBYSxFQUNiQyxTQUFpQixHQUFHO0lBRXBCLE9BQU8sSUFBSUosU0FDVEMsS0FBS0MsU0FBUyxDQUFDO1FBQUVDO0lBQU0sSUFDdkI7UUFDRUM7UUFDQUMsU0FBUztZQUFFLGdCQUFnQjtRQUFtQjtJQUNoRDtBQUVKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY29tbWlzc2FibGUtY3JtLy4vbGliL2FwaS1hdXRoLnRzP2IzMGUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QgfSBmcm9tICduZXh0L3NlcnZlcidcclxuaW1wb3J0IHsgZ2V0QXV0aGVudGljYXRlZFVzZXIsIGhhc1Blcm1pc3Npb24sIGhhc0FueVBlcm1pc3Npb24sIGhhc0FsbFBlcm1pc3Npb25zIH0gZnJvbSAnLi9hdXRoJ1xyXG5pbXBvcnQgdHlwZSB7IEF1dGhVc2VyIH0gZnJvbSAnLi9hdXRoJ1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBBcGlSZXNwb25zZTxUID0gYW55PiB7XHJcbiAgZGF0YT86IFRcclxuICBlcnJvcj86IHN0cmluZ1xyXG4gIG1lc3NhZ2U/OiBzdHJpbmdcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBBdXRoZW50aWNhdGVkUmVxdWVzdCBleHRlbmRzIE5leHRSZXF1ZXN0IHtcclxuICB1c2VyOiBBdXRoVXNlclxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gd2l0aEF1dGg8VCA9IGFueT4oXHJcbiAgcmVxdWVzdDogTmV4dFJlcXVlc3QsXHJcbiAgaGFuZGxlcjogKHJlcXVlc3Q6IEF1dGhlbnRpY2F0ZWRSZXF1ZXN0KSA9PiBQcm9taXNlPFJlc3BvbnNlIHwgQXBpUmVzcG9uc2U8VD4+XHJcbik6IFByb21pc2U8UmVzcG9uc2U+IHtcclxuICB0cnkge1xyXG4gICAgLy8gR2V0IGF1dGhlbnRpY2F0ZWQgdXNlclxyXG4gICAgY29uc3QgdXNlciA9IGF3YWl0IGdldEF1dGhlbnRpY2F0ZWRVc2VyKClcclxuXHJcbiAgICBpZiAoIXVzZXIpIHtcclxuICAgICAgcmV0dXJuIG5ldyBSZXNwb25zZShcclxuICAgICAgICBKU09OLnN0cmluZ2lmeSh7IGVycm9yOiAnQXV0aGVudGljYXRpb24gcmVxdWlyZWQnIH0pLFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIHN0YXR1czogNDAxLFxyXG4gICAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH1cclxuICAgICAgICB9XHJcbiAgICAgIClcclxuICAgIH1cclxuXHJcbiAgICAvLyBBZGQgdXNlciB0byByZXF1ZXN0IG9iamVjdFxyXG4gICAgY29uc3QgYXV0aGVudGljYXRlZFJlcXVlc3QgPSByZXF1ZXN0IGFzIEF1dGhlbnRpY2F0ZWRSZXF1ZXN0XHJcbiAgICBhdXRoZW50aWNhdGVkUmVxdWVzdC51c2VyID0gdXNlclxyXG5cclxuICAgIC8vIENhbGwgdGhlIGhhbmRsZXJcclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGhhbmRsZXIoYXV0aGVudGljYXRlZFJlcXVlc3QpXHJcblxyXG4gICAgLy8gSWYgcmVzdWx0IGlzIGFscmVhZHkgYSBSZXNwb25zZSwgcmV0dXJuIGl0XHJcbiAgICBpZiAocmVzdWx0IGluc3RhbmNlb2YgUmVzcG9uc2UpIHtcclxuICAgICAgcmV0dXJuIHJlc3VsdFxyXG4gICAgfVxyXG5cclxuICAgIC8vIE90aGVyd2lzZSwgd3JhcCBpbiBSZXNwb25zZVxyXG4gICAgcmV0dXJuIG5ldyBSZXNwb25zZShcclxuICAgICAgSlNPTi5zdHJpbmdpZnkocmVzdWx0KSxcclxuICAgICAge1xyXG4gICAgICAgIHN0YXR1czogMjAwLFxyXG4gICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9XHJcbiAgICAgIH1cclxuICAgIClcclxuXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0FQSSBlcnJvcjonLCBlcnJvcilcclxuICAgIHJldHVybiBuZXcgUmVzcG9uc2UoXHJcbiAgICAgIEpTT04uc3RyaW5naWZ5KHsgZXJyb3I6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InIH0pLFxyXG4gICAgICB7XHJcbiAgICAgICAgc3RhdHVzOiA1MDAsXHJcbiAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH1cclxuICAgICAgfVxyXG4gICAgKVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHdpdGhQZXJtaXNzaW9uczxUID0gYW55PihcclxuICByZXF1ZXN0OiBOZXh0UmVxdWVzdCxcclxuICBwZXJtaXNzaW9uczogc3RyaW5nW10sXHJcbiAgaGFuZGxlcjogKHJlcXVlc3Q6IEF1dGhlbnRpY2F0ZWRSZXF1ZXN0KSA9PiBQcm9taXNlPFJlc3BvbnNlIHwgQXBpUmVzcG9uc2U8VD4+LFxyXG4gIG9wdGlvbnM6IHtcclxuICAgIHJlcXVpcmVBbGw/OiBib29sZWFuIC8vIElmIHRydWUsIHVzZXIgbXVzdCBoYXZlIEFMTCBwZXJtaXNzaW9uczsgaWYgZmFsc2UsIHVzZXIgbmVlZHMgQU5ZIHBlcm1pc3Npb25cclxuICB9ID0ge31cclxuKTogUHJvbWlzZTxSZXNwb25zZT4ge1xyXG4gIGNvbnN0IHsgcmVxdWlyZUFsbCA9IGZhbHNlIH0gPSBvcHRpb25zXHJcblxyXG4gIHJldHVybiB3aXRoQXV0aChyZXF1ZXN0LCBhc3luYyAoYXV0aGVudGljYXRlZFJlcXVlc3QpID0+IHtcclxuICAgIGNvbnN0IHsgdXNlciB9ID0gYXV0aGVudGljYXRlZFJlcXVlc3RcclxuXHJcbiAgICAvLyBDaGVjayBwZXJtaXNzaW9uc1xyXG4gICAgY29uc3QgaGFzUmVxdWlyZWRQZXJtaXNzaW9ucyA9IHJlcXVpcmVBbGxcclxuICAgICAgPyBoYXNBbGxQZXJtaXNzaW9ucyh1c2VyLCBwZXJtaXNzaW9ucylcclxuICAgICAgOiBoYXNBbnlQZXJtaXNzaW9uKHVzZXIsIHBlcm1pc3Npb25zKVxyXG5cclxuICAgIGlmICghaGFzUmVxdWlyZWRQZXJtaXNzaW9ucykge1xyXG4gICAgICByZXR1cm4gbmV3IFJlc3BvbnNlKFxyXG4gICAgICAgIEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgIGVycm9yOiAnSW5zdWZmaWNpZW50IHBlcm1pc3Npb25zJyxcclxuICAgICAgICAgIHJlcXVpcmVkOiBwZXJtaXNzaW9ucyxcclxuICAgICAgICAgIHJlcXVpcmVBbGxcclxuICAgICAgICB9KSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBzdGF0dXM6IDQwMyxcclxuICAgICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9XHJcbiAgICAgICAgfVxyXG4gICAgICApXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGhhbmRsZXIoYXV0aGVudGljYXRlZFJlcXVlc3QpXHJcbiAgfSlcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHdpdGhSb2xlPFQgPSBhbnk+KFxyXG4gIHJlcXVlc3Q6IE5leHRSZXF1ZXN0LFxyXG4gIHJvbGVzOiBzdHJpbmdbXSxcclxuICBoYW5kbGVyOiAocmVxdWVzdDogQXV0aGVudGljYXRlZFJlcXVlc3QpID0+IFByb21pc2U8UmVzcG9uc2UgfCBBcGlSZXNwb25zZTxUPj5cclxuKTogUHJvbWlzZTxSZXNwb25zZT4ge1xyXG4gIHJldHVybiB3aXRoQXV0aChyZXF1ZXN0LCBhc3luYyAoYXV0aGVudGljYXRlZFJlcXVlc3QpID0+IHtcclxuICAgIGNvbnN0IHsgdXNlciB9ID0gYXV0aGVudGljYXRlZFJlcXVlc3RcclxuXHJcbiAgICAvLyBDaGVjayByb2xlXHJcbiAgICBpZiAoIXVzZXIucm9sZSB8fCAhcm9sZXMuaW5jbHVkZXModXNlci5yb2xlLmNvZGUpKSB7XHJcbiAgICAgIHJldHVybiBuZXcgUmVzcG9uc2UoXHJcbiAgICAgICAgSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgZXJyb3I6ICdJbnN1ZmZpY2llbnQgcm9sZSBhY2Nlc3MnLFxyXG4gICAgICAgICAgcmVxdWlyZWQ6IHJvbGVzLFxyXG4gICAgICAgICAgY3VycmVudDogdXNlci5yb2xlPy5jb2RlIHx8IG51bGxcclxuICAgICAgICB9KSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBzdGF0dXM6IDQwMyxcclxuICAgICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9XHJcbiAgICAgICAgfVxyXG4gICAgICApXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGhhbmRsZXIoYXV0aGVudGljYXRlZFJlcXVlc3QpXHJcbiAgfSlcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUFwaVJlc3BvbnNlPFQ+KFxyXG4gIGRhdGE6IFQsXHJcbiAgc3RhdHVzOiBudW1iZXIgPSAyMDAsXHJcbiAgbWVzc2FnZT86IHN0cmluZ1xyXG4pOiBSZXNwb25zZSB7XHJcbiAgY29uc3QgcmVzcG9uc2U6IEFwaVJlc3BvbnNlPFQ+ID0geyBkYXRhIH1cclxuICBpZiAobWVzc2FnZSkgcmVzcG9uc2UubWVzc2FnZSA9IG1lc3NhZ2VcclxuXHJcbiAgcmV0dXJuIG5ldyBSZXNwb25zZShcclxuICAgIEpTT04uc3RyaW5naWZ5KHJlc3BvbnNlKSxcclxuICAgIHtcclxuICAgICAgc3RhdHVzLFxyXG4gICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfVxyXG4gICAgfVxyXG4gIClcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUVycm9yUmVzcG9uc2UoXHJcbiAgZXJyb3I6IHN0cmluZyxcclxuICBzdGF0dXM6IG51bWJlciA9IDQwMFxyXG4pOiBSZXNwb25zZSB7XHJcbiAgcmV0dXJuIG5ldyBSZXNwb25zZShcclxuICAgIEpTT04uc3RyaW5naWZ5KHsgZXJyb3IgfSksXHJcbiAgICB7XHJcbiAgICAgIHN0YXR1cyxcclxuICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH1cclxuICAgIH1cclxuICApXHJcbn0iXSwibmFtZXMiOlsiZ2V0QXV0aGVudGljYXRlZFVzZXIiLCJoYXNBbnlQZXJtaXNzaW9uIiwiaGFzQWxsUGVybWlzc2lvbnMiLCJ3aXRoQXV0aCIsInJlcXVlc3QiLCJoYW5kbGVyIiwidXNlciIsIlJlc3BvbnNlIiwiSlNPTiIsInN0cmluZ2lmeSIsImVycm9yIiwic3RhdHVzIiwiaGVhZGVycyIsImF1dGhlbnRpY2F0ZWRSZXF1ZXN0IiwicmVzdWx0IiwiY29uc29sZSIsIndpdGhQZXJtaXNzaW9ucyIsInBlcm1pc3Npb25zIiwib3B0aW9ucyIsInJlcXVpcmVBbGwiLCJoYXNSZXF1aXJlZFBlcm1pc3Npb25zIiwicmVxdWlyZWQiLCJ3aXRoUm9sZSIsInJvbGVzIiwicm9sZSIsImluY2x1ZGVzIiwiY29kZSIsImN1cnJlbnQiLCJjcmVhdGVBcGlSZXNwb25zZSIsImRhdGEiLCJtZXNzYWdlIiwicmVzcG9uc2UiLCJjcmVhdGVFcnJvclJlc3BvbnNlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/api-auth.ts\n");

/***/ }),

/***/ "(rsc)/./lib/audit.ts":
/*!**********************!*\
  !*** ./lib/audit.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getChangedFields: () => (/* binding */ getChangedFields),\n/* harmony export */   getClientIP: () => (/* binding */ getClientIP),\n/* harmony export */   getUserAgent: () => (/* binding */ getUserAgent),\n/* harmony export */   logAccountAudit: () => (/* binding */ logAccountAudit),\n/* harmony export */   logAudit: () => (/* binding */ logAudit),\n/* harmony export */   logContactAudit: () => (/* binding */ logContactAudit),\n/* harmony export */   logUserAudit: () => (/* binding */ logUserAudit)\n/* harmony export */ });\n/* harmony import */ var _db__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./db */ \"(rsc)/./lib/db.ts\");\n\n/**\n * Centralized audit logging utility\n * Logs all CRUD operations and system events for compliance and tracking\n */ async function logAudit(params) {\n    try {\n        await _db__WEBPACK_IMPORTED_MODULE_0__.prisma.auditLog.create({\n            data: {\n                tenantId: params.tenantId,\n                userId: params.userId,\n                action: params.action,\n                entityName: params.entityName,\n                entityId: params.entityId,\n                requestId: params.requestId,\n                changedFields: params.changedFields ? JSON.stringify(params.changedFields) : undefined,\n                previousValues: params.previousValues ? JSON.stringify(params.previousValues) : undefined,\n                newValues: params.newValues ? JSON.stringify(params.newValues) : undefined,\n                ipAddress: params.ipAddress,\n                userAgent: params.userAgent,\n                metadata: params.metadata ? JSON.stringify(params.metadata) : undefined\n            }\n        });\n    } catch (error) {\n        // Don't throw errors from audit logging to avoid breaking main operations\n        console.error(\"Failed to log audit event:\", error);\n    }\n}\n/**\n * Helper function to extract changed fields between two objects\n */ function getChangedFields(previous, current) {\n    const changed = {};\n    // Check for changed values\n    for(const key in current){\n        if (previous[key] !== current[key]) {\n            changed[key] = {\n                from: previous[key],\n                to: current[key]\n            };\n        }\n    }\n    // Check for removed fields\n    for(const key in previous){\n        if (!(key in current)) {\n            changed[key] = {\n                from: previous[key],\n                to: null\n            };\n        }\n    }\n    return changed;\n}\n/**\n * Helper function to get client IP from request headers\n */ function getClientIP(request) {\n    const forwarded = request.headers.get(\"x-forwarded-for\");\n    const realIP = request.headers.get(\"x-real-ip\");\n    const cfConnectingIP = request.headers.get(\"cf-connecting-ip\");\n    if (forwarded) {\n        return forwarded.split(\",\")[0].trim();\n    }\n    if (realIP) {\n        return realIP;\n    }\n    if (cfConnectingIP) {\n        return cfConnectingIP;\n    }\n    return undefined;\n}\n/**\n * Helper function to get user agent from request headers\n */ function getUserAgent(request) {\n    return request.headers.get(\"user-agent\") || undefined;\n}\n/**\n * Audit logging for account operations\n */ async function logAccountAudit(action, accountId, userId, tenantId, request, previousValues, newValues) {\n    const changedFields = previousValues && newValues ? getChangedFields(previousValues, newValues) : undefined;\n    await logAudit({\n        userId,\n        tenantId,\n        action,\n        entityName: \"Account\",\n        entityId: accountId,\n        changedFields,\n        previousValues,\n        newValues,\n        ipAddress: getClientIP(request),\n        userAgent: getUserAgent(request)\n    });\n}\n/**\n * Audit logging for contact operations\n */ async function logContactAudit(action, contactId, userId, tenantId, request, previousValues, newValues) {\n    const changedFields = previousValues && newValues ? getChangedFields(previousValues, newValues) : undefined;\n    await logAudit({\n        userId,\n        tenantId,\n        action,\n        entityName: \"Contact\",\n        entityId: contactId,\n        changedFields,\n        previousValues,\n        newValues,\n        ipAddress: getClientIP(request),\n        userAgent: getUserAgent(request)\n    });\n}\n/**\n * Audit logging for user operations\n */ async function logUserAudit(action, targetUserId, userId, tenantId, request, previousValues, newValues) {\n    const changedFields = previousValues && newValues ? getChangedFields(previousValues, newValues) : undefined;\n    await logAudit({\n        userId,\n        tenantId,\n        action,\n        entityName: \"User\",\n        entityId: targetUserId,\n        changedFields,\n        previousValues,\n        newValues,\n        ipAddress: getClientIP(request),\n        userAgent: getUserAgent(request)\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0FEO1FBQ0FFO1FBQ0FDLFlBQVk7UUFDWkMsVUFBVStCO1FBQ1Y3QjtRQUNBSTtRQUNBQztRQUNBQyxXQUFXWSxZQUFZQztRQUN2QlosV0FBV29CLGFBQWFSO0lBQzFCO0FBQ0Y7QUFFQTs7Q0FFQyxHQUNNLGVBQWVXLGdCQUNwQmxDLE1BQW1CLEVBQ25CbUMsU0FBaUIsRUFDakJwQyxNQUFjLEVBQ2RELFFBQWdCLEVBQ2hCeUIsT0FBZ0IsRUFDaEJmLGNBQW9DLEVBQ3BDQyxTQUErQjtJQUUvQixNQUFNTCxnQkFBZ0JJLGtCQUFrQkMsWUFDcENNLGlCQUFpQlAsZ0JBQWdCQyxhQUNqQ0Y7SUFFSixNQUFNZCxTQUFTO1FBQ2JNO1FBQ0FEO1FBQ0FFO1FBQ0FDLFlBQVk7UUFDWkMsVUFBVWlDO1FBQ1YvQjtRQUNBSTtRQUNBQztRQUNBQyxXQUFXWSxZQUFZQztRQUN2QlosV0FBV29CLGFBQWFSO0lBQzFCO0FBQ0Y7QUFFQTs7Q0FFQyxHQUNNLGVBQWVhLGFBQ3BCcEMsTUFBbUIsRUFDbkJxQyxZQUFvQixFQUNwQnRDLE1BQWMsRUFDZEQsUUFBZ0IsRUFDaEJ5QixPQUFnQixFQUNoQmYsY0FBb0MsRUFDcENDLFNBQStCO0lBRS9CLE1BQU1MLGdCQUFnQkksa0JBQWtCQyxZQUNwQ00saUJBQWlCUCxnQkFBZ0JDLGFBQ2pDRjtJQUVKLE1BQU1kLFNBQVM7UUFDYk07UUFDQUQ7UUFDQUU7UUFDQUMsWUFBWTtRQUNaQyxVQUFVbUM7UUFDVmpDO1FBQ0FJO1FBQ0FDO1FBQ0FDLFdBQVdZLFlBQVlDO1FBQ3ZCWixXQUFXb0IsYUFBYVI7SUFDMUI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2NvbW1pc3NhYmxlLWNybS8uL2xpYi9hdWRpdC50cz9iM2VlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHByaXNtYSB9IGZyb20gJy4vZGInXG5pbXBvcnQgeyBBdWRpdEFjdGlvbiB9IGZyb20gJ0BwcmlzbWEvY2xpZW50J1xuXG5leHBvcnQgaW50ZXJmYWNlIEF1ZGl0TG9nUGFyYW1zIHtcbiAgdXNlcklkOiBzdHJpbmdcbiAgdGVuYW50SWQ6IHN0cmluZ1xuICBhY3Rpb246IEF1ZGl0QWN0aW9uXG4gIGVudGl0eU5hbWU6IHN0cmluZ1xuICBlbnRpdHlJZDogc3RyaW5nXG4gIHJlcXVlc3RJZD86IHN0cmluZ1xuICBjaGFuZ2VkRmllbGRzPzogUmVjb3JkPHN0cmluZywgYW55PlxuICBwcmV2aW91c1ZhbHVlcz86IFJlY29yZDxzdHJpbmcsIGFueT5cbiAgbmV3VmFsdWVzPzogUmVjb3JkPHN0cmluZywgYW55PlxuICBpcEFkZHJlc3M/OiBzdHJpbmdcbiAgdXNlckFnZW50Pzogc3RyaW5nXG4gIG1ldGFkYXRhPzogUmVjb3JkPHN0cmluZywgYW55PlxufVxuXG4vKipcbiAqIENlbnRyYWxpemVkIGF1ZGl0IGxvZ2dpbmcgdXRpbGl0eVxuICogTG9ncyBhbGwgQ1JVRCBvcGVyYXRpb25zIGFuZCBzeXN0ZW0gZXZlbnRzIGZvciBjb21wbGlhbmNlIGFuZCB0cmFja2luZ1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9nQXVkaXQocGFyYW1zOiBBdWRpdExvZ1BhcmFtcyk6IFByb21pc2U8dm9pZD4ge1xuICB0cnkge1xuICAgIGF3YWl0IHByaXNtYS5hdWRpdExvZy5jcmVhdGUoe1xuICAgICAgZGF0YToge1xuICAgICAgICB0ZW5hbnRJZDogcGFyYW1zLnRlbmFudElkLFxuICAgICAgICB1c2VySWQ6IHBhcmFtcy51c2VySWQsXG4gICAgICAgIGFjdGlvbjogcGFyYW1zLmFjdGlvbixcbiAgICAgICAgZW50aXR5TmFtZTogcGFyYW1zLmVudGl0eU5hbWUsXG4gICAgICAgIGVudGl0eUlkOiBwYXJhbXMuZW50aXR5SWQsXG4gICAgICAgIHJlcXVlc3RJZDogcGFyYW1zLnJlcXVlc3RJZCxcbiAgICAgICAgY2hhbmdlZEZpZWxkczogcGFyYW1zLmNoYW5nZWRGaWVsZHMgPyBKU09OLnN0cmluZ2lmeShwYXJhbXMuY2hhbmdlZEZpZWxkcykgOiB1bmRlZmluZWQsIFxuICAgICAgICBwcmV2aW91c1ZhbHVlczogcGFyYW1zLnByZXZpb3VzVmFsdWVzID8gSlNPTi5zdHJpbmdpZnkocGFyYW1zLnByZXZpb3VzVmFsdWVzKSA6IHVuZGVmaW5lZCxcbiAgICAgICAgbmV3VmFsdWVzOiBwYXJhbXMubmV3VmFsdWVzID8gSlNPTi5zdHJpbmdpZnkocGFyYW1zLm5ld1ZhbHVlcykgOiB1bmRlZmluZWQsXG4gICAgICAgIGlwQWRkcmVzczogcGFyYW1zLmlwQWRkcmVzcyxcbiAgICAgICAgdXNlckFnZW50OiBwYXJhbXMudXNlckFnZW50LFxuICAgICAgICBtZXRhZGF0YTogcGFyYW1zLm1ldGFkYXRhID8gSlNPTi5zdHJpbmdpZnkocGFyYW1zLm1ldGFkYXRhKSA6IHVuZGVmaW5lZFxuICAgICAgfVxuICAgIH0pXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgLy8gRG9uJ3QgdGhyb3cgZXJyb3JzIGZyb20gYXVkaXQgbG9nZ2luZyB0byBhdm9pZCBicmVha2luZyBtYWluIG9wZXJhdGlvbnNcbiAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gbG9nIGF1ZGl0IGV2ZW50OicsIGVycm9yKVxuICB9XG59XG5cbi8qKlxuICogSGVscGVyIGZ1bmN0aW9uIHRvIGV4dHJhY3QgY2hhbmdlZCBmaWVsZHMgYmV0d2VlbiB0d28gb2JqZWN0c1xuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q2hhbmdlZEZpZWxkcyhwcmV2aW91czogUmVjb3JkPHN0cmluZywgYW55PiwgY3VycmVudDogUmVjb3JkPHN0cmluZywgYW55Pik6IFJlY29yZDxzdHJpbmcsIGFueT4ge1xuICBjb25zdCBjaGFuZ2VkOiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0ge31cbiAgXG4gIC8vIENoZWNrIGZvciBjaGFuZ2VkIHZhbHVlc1xuICBmb3IgKGNvbnN0IGtleSBpbiBjdXJyZW50KSB7XG4gICAgaWYgKHByZXZpb3VzW2tleV0gIT09IGN1cnJlbnRba2V5XSkge1xuICAgICAgY2hhbmdlZFtrZXldID0ge1xuICAgICAgICBmcm9tOiBwcmV2aW91c1trZXldLFxuICAgICAgICB0bzogY3VycmVudFtrZXldXG4gICAgICB9XG4gICAgfVxuICB9XG4gIFxuICAvLyBDaGVjayBmb3IgcmVtb3ZlZCBmaWVsZHNcbiAgZm9yIChjb25zdCBrZXkgaW4gcHJldmlvdXMpIHtcbiAgICBpZiAoIShrZXkgaW4gY3VycmVudCkpIHtcbiAgICAgIGNoYW5nZWRba2V5XSA9IHtcbiAgICAgICAgZnJvbTogcHJldmlvdXNba2V5XSxcbiAgICAgICAgdG86IG51bGxcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgXG4gIHJldHVybiBjaGFuZ2VkXG59XG5cbi8qKlxuICogSGVscGVyIGZ1bmN0aW9uIHRvIGdldCBjbGllbnQgSVAgZnJvbSByZXF1ZXN0IGhlYWRlcnNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldENsaWVudElQKHJlcXVlc3Q6IFJlcXVlc3QpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICBjb25zdCBmb3J3YXJkZWQgPSByZXF1ZXN0LmhlYWRlcnMuZ2V0KCd4LWZvcndhcmRlZC1mb3InKVxuICBjb25zdCByZWFsSVAgPSByZXF1ZXN0LmhlYWRlcnMuZ2V0KCd4LXJlYWwtaXAnKVxuICBjb25zdCBjZkNvbm5lY3RpbmdJUCA9IHJlcXVlc3QuaGVhZGVycy5nZXQoJ2NmLWNvbm5lY3RpbmctaXAnKVxuICBcbiAgaWYgKGZvcndhcmRlZCkge1xuICAgIHJldHVybiBmb3J3YXJkZWQuc3BsaXQoJywnKVswXS50cmltKClcbiAgfVxuICBcbiAgaWYgKHJlYWxJUCkge1xuICAgIHJldHVybiByZWFsSVBcbiAgfVxuICBcbiAgaWYgKGNmQ29ubmVjdGluZ0lQKSB7XG4gICAgcmV0dXJuIGNmQ29ubmVjdGluZ0lQXG4gIH1cbiAgXG4gIHJldHVybiB1bmRlZmluZWRcbn1cblxuLyoqXG4gKiBIZWxwZXIgZnVuY3Rpb24gdG8gZ2V0IHVzZXIgYWdlbnQgZnJvbSByZXF1ZXN0IGhlYWRlcnNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFVzZXJBZ2VudChyZXF1ZXN0OiBSZXF1ZXN0KTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgcmV0dXJuIHJlcXVlc3QuaGVhZGVycy5nZXQoJ3VzZXItYWdlbnQnKSB8fCB1bmRlZmluZWRcbn1cblxuLyoqXG4gKiBBdWRpdCBsb2dnaW5nIGZvciBhY2NvdW50IG9wZXJhdGlvbnNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxvZ0FjY291bnRBdWRpdChcbiAgYWN0aW9uOiBBdWRpdEFjdGlvbixcbiAgYWNjb3VudElkOiBzdHJpbmcsXG4gIHVzZXJJZDogc3RyaW5nLFxuICB0ZW5hbnRJZDogc3RyaW5nLFxuICByZXF1ZXN0OiBSZXF1ZXN0LFxuICBwcmV2aW91c1ZhbHVlcz86IFJlY29yZDxzdHJpbmcsIGFueT4sXG4gIG5ld1ZhbHVlcz86IFJlY29yZDxzdHJpbmcsIGFueT5cbik6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCBjaGFuZ2VkRmllbGRzID0gcHJldmlvdXNWYWx1ZXMgJiYgbmV3VmFsdWVzIFxuICAgID8gZ2V0Q2hhbmdlZEZpZWxkcyhwcmV2aW91c1ZhbHVlcywgbmV3VmFsdWVzKVxuICAgIDogdW5kZWZpbmVkXG5cbiAgYXdhaXQgbG9nQXVkaXQoe1xuICAgIHVzZXJJZCxcbiAgICB0ZW5hbnRJZCxcbiAgICBhY3Rpb24sXG4gICAgZW50aXR5TmFtZTogJ0FjY291bnQnLFxuICAgIGVudGl0eUlkOiBhY2NvdW50SWQsXG4gICAgY2hhbmdlZEZpZWxkcyxcbiAgICBwcmV2aW91c1ZhbHVlcyxcbiAgICBuZXdWYWx1ZXMsXG4gICAgaXBBZGRyZXNzOiBnZXRDbGllbnRJUChyZXF1ZXN0KSxcbiAgICB1c2VyQWdlbnQ6IGdldFVzZXJBZ2VudChyZXF1ZXN0KVxuICB9KVxufVxuXG4vKipcbiAqIEF1ZGl0IGxvZ2dpbmcgZm9yIGNvbnRhY3Qgb3BlcmF0aW9uc1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9nQ29udGFjdEF1ZGl0KFxuICBhY3Rpb246IEF1ZGl0QWN0aW9uLFxuICBjb250YWN0SWQ6IHN0cmluZyxcbiAgdXNlcklkOiBzdHJpbmcsXG4gIHRlbmFudElkOiBzdHJpbmcsXG4gIHJlcXVlc3Q6IFJlcXVlc3QsXG4gIHByZXZpb3VzVmFsdWVzPzogUmVjb3JkPHN0cmluZywgYW55PixcbiAgbmV3VmFsdWVzPzogUmVjb3JkPHN0cmluZywgYW55PlxuKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IGNoYW5nZWRGaWVsZHMgPSBwcmV2aW91c1ZhbHVlcyAmJiBuZXdWYWx1ZXMgXG4gICAgPyBnZXRDaGFuZ2VkRmllbGRzKHByZXZpb3VzVmFsdWVzLCBuZXdWYWx1ZXMpXG4gICAgOiB1bmRlZmluZWRcblxuICBhd2FpdCBsb2dBdWRpdCh7XG4gICAgdXNlcklkLFxuICAgIHRlbmFudElkLFxuICAgIGFjdGlvbixcbiAgICBlbnRpdHlOYW1lOiAnQ29udGFjdCcsXG4gICAgZW50aXR5SWQ6IGNvbnRhY3RJZCxcbiAgICBjaGFuZ2VkRmllbGRzLFxuICAgIHByZXZpb3VzVmFsdWVzLFxuICAgIG5ld1ZhbHVlcyxcbiAgICBpcEFkZHJlc3M6IGdldENsaWVudElQKHJlcXVlc3QpLFxuICAgIHVzZXJBZ2VudDogZ2V0VXNlckFnZW50KHJlcXVlc3QpXG4gIH0pXG59XG5cbi8qKlxuICogQXVkaXQgbG9nZ2luZyBmb3IgdXNlciBvcGVyYXRpb25zXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2dVc2VyQXVkaXQoXG4gIGFjdGlvbjogQXVkaXRBY3Rpb24sXG4gIHRhcmdldFVzZXJJZDogc3RyaW5nLFxuICB1c2VySWQ6IHN0cmluZyxcbiAgdGVuYW50SWQ6IHN0cmluZyxcbiAgcmVxdWVzdDogUmVxdWVzdCxcbiAgcHJldmlvdXNWYWx1ZXM/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+LFxuICBuZXdWYWx1ZXM/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+XG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgY2hhbmdlZEZpZWxkcyA9IHByZXZpb3VzVmFsdWVzICYmIG5ld1ZhbHVlcyBcbiAgICA/IGdldENoYW5nZWRGaWVsZHMocHJldmlvdXNWYWx1ZXMsIG5ld1ZhbHVlcylcbiAgICA6IHVuZGVmaW5lZFxuXG4gIGF3YWl0IGxvZ0F1ZGl0KHtcbiAgICB1c2VySWQsXG4gICAgdGVuYW50SWQsXG4gICAgYWN0aW9uLFxuICAgIGVudGl0eU5hbWU6ICdVc2VyJyxcbiAgICBlbnRpdHlJZDogdGFyZ2V0VXNlcklkLFxuICAgIGNoYW5nZWRGaWVsZHMsXG4gICAgcHJldmlvdXNWYWx1ZXMsXG4gICAgbmV3VmFsdWVzLFxuICAgIGlwQWRkcmVzczogZ2V0Q2xpZW50SVAocmVxdWVzdCksXG4gICAgdXNlckFnZW50OiBnZXRVc2VyQWdlbnQocmVxdWVzdClcbiAgfSlcbn1cbiJdLCJuYW1lcyI6WyJwcmlzbWEiLCJsb2dBdWRpdCIsInBhcmFtcyIsImF1ZGl0TG9nIiwiY3JlYXRlIiwiZGF0YSIsInRlbmFudElkIiwidXNlcklkIiwiYWN0aW9uIiwiZW50aXR5TmFtZSIsImVudGl0eUlkIiwicmVxdWVzdElkIiwiY2hhbmdlZEZpZWxkcyIsIkpTT04iLCJzdHJpbmdpZnkiLCJ1bmRlZmluZWQiLCJwcmV2aW91c1ZhbHVlcyIsIm5ld1ZhbHVlcyIsImlwQWRkcmVzcyIsInVzZXJBZ2VudCIsIm1ldGFkYXRhIiwiZXJyb3IiLCJjb25zb2xlIiwiZ2V0Q2hhbmdlZEZpZWxkcyIsInByZXZpb3VzIiwiY3VycmVudCIsImNoYW5nZWQiLCJrZXkiLCJmcm9tIiwidG8iLCJnZXRDbGllbnRJUCIsInJlcXVlc3QiLCJmb3J3YXJkZWQiLCJoZWFkZXJzIiwiZ2V0IiwicmVhbElQIiwiY2ZDb25uZWN0aW5nSVAiLCJzcGxpdCIsInRyaW0iLCJnZXRVc2VyQWdlbnQiLCJsb2dBY2NvdW50QXVkaXQiLCJhY2NvdW50SWQiLCJsb2dDb250YWN0QXVkaXQiLCJjb250YWN0SWQiLCJsb2dVc2VyQXVkaXQiLCJ0YXJnZXRVc2VySWQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/audit.ts\n");

/***/ }),

/***/ "(rsc)/./lib/auth.ts":
/*!*********************!*\
  !*** ./lib/auth.ts ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   cleanupExpiredSessions: () => (/* binding */ cleanupExpiredSessions),\n/* harmony export */   clearSessionCookie: () => (/* binding */ clearSessionCookie),\n/* harmony export */   createUserSession: () => (/* binding */ createUserSession),\n/* harmony export */   getAuthenticatedUser: () => (/* binding */ getAuthenticatedUser),\n/* harmony export */   hasAllPermissions: () => (/* binding */ hasAllPermissions),\n/* harmony export */   hasAnyPermission: () => (/* binding */ hasAnyPermission),\n/* harmony export */   hasPermission: () => (/* binding */ hasPermission),\n/* harmony export */   hashPassword: () => (/* binding */ hashPassword),\n/* harmony export */   setSessionCookie: () => (/* binding */ setSessionCookie),\n/* harmony export */   terminateAllUserSessions: () => (/* binding */ terminateAllUserSessions),\n/* harmony export */   terminateSession: () => (/* binding */ terminateSession),\n/* harmony export */   verifyPassword: () => (/* binding */ verifyPassword)\n/* harmony export */ });\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var _db__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./db */ \"(rsc)/./lib/db.ts\");\n\n\n\n\nconst ONE_DAY_MS = 24 * 60 * 60 * 1000;\nconst SALT_ROUNDS = 12;\nfunction resolveSessionDurationDays() {\n    const raw = process.env.SESSION_DURATION_DAYS ?? \"7\";\n    const parsed = Number.parseInt(raw, 10);\n    if (!Number.isFinite(parsed) || parsed <= 0) {\n        console.warn(`SESSION_DURATION_DAYS must be a positive integer, received \"${raw}\". Using default: 7`);\n        return 7;\n    }\n    return parsed;\n}\nconst SESSION_DURATION_DAYS = resolveSessionDurationDays();\nconst SESSION_DURATION_MS = SESSION_DURATION_DAYS * ONE_DAY_MS;\nasync function hashPassword(password) {\n    return bcryptjs__WEBPACK_IMPORTED_MODULE_0__[\"default\"].hash(password, SALT_ROUNDS);\n}\nasync function verifyPassword(password, hash) {\n    return bcryptjs__WEBPACK_IMPORTED_MODULE_0__[\"default\"].compare(password, hash);\n}\nfunction generateOpaqueToken() {\n    return crypto__WEBPACK_IMPORTED_MODULE_1___default().randomBytes(32).toString(\"base64url\");\n}\nasync function createUserSession(userId, tenantId, ipAddress, userAgent) {\n    const sessionToken = generateOpaqueToken();\n    const expiresAt = new Date(Date.now() + SESSION_DURATION_MS);\n    const session = await _db__WEBPACK_IMPORTED_MODULE_3__.prisma.userSession.create({\n        data: {\n            tenantId,\n            userId,\n            sessionToken,\n            ipAddress: ipAddress ?? null,\n            userAgent: userAgent ?? null,\n            expiresAt,\n            lastSeenAt: new Date()\n        }\n    });\n    return {\n        sessionToken,\n        sessionId: session.id,\n        expiresAt\n    };\n}\nasync function getAuthenticatedUser(sessionToken) {\n    if (!sessionToken) {\n        const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_2__.cookies)();\n        sessionToken = cookieStore.get(\"session-token\")?.value;\n    }\n    if (!sessionToken) {\n        return null;\n    }\n    const session = await _db__WEBPACK_IMPORTED_MODULE_3__.prisma.userSession.findFirst({\n        where: {\n            sessionToken,\n            expiresAt: {\n                gt: new Date()\n            },\n            terminatedAt: null\n        }\n    });\n    if (!session) {\n        return null;\n    }\n    await _db__WEBPACK_IMPORTED_MODULE_3__.prisma.userSession.update({\n        where: {\n            id: session.id\n        },\n        data: {\n            lastSeenAt: new Date()\n        }\n    });\n    const user = await _db__WEBPACK_IMPORTED_MODULE_3__.prisma.user.findFirst({\n        where: {\n            id: session.userId,\n            tenantId: session.tenantId,\n            status: {\n                in: [\n                    \"Active\",\n                    \"Invited\"\n                ]\n            }\n        },\n        include: {\n            role: {\n                include: {\n                    permissions: {\n                        include: {\n                            permission: true\n                        }\n                    }\n                }\n            }\n        }\n    });\n    if (!user) {\n        return null;\n    }\n    return {\n        id: user.id,\n        tenantId: user.tenantId,\n        email: user.email,\n        firstName: user.firstName,\n        lastName: user.lastName,\n        fullName: user.fullName,\n        roleId: user.roleId,\n        status: user.status,\n        role: user.role ? {\n            id: user.role.id,\n            code: user.role.code,\n            name: user.role.name,\n            permissions: user.role.permissions.map((rp)=>({\n                    id: rp.permission.id,\n                    code: rp.permission.code,\n                    name: rp.permission.name,\n                    category: rp.permission.category\n                }))\n        } : undefined\n    };\n}\nasync function terminateSession(sessionId) {\n    await _db__WEBPACK_IMPORTED_MODULE_3__.prisma.userSession.update({\n        where: {\n            id: sessionId\n        },\n        data: {\n            terminatedAt: new Date()\n        }\n    });\n}\nasync function terminateAllUserSessions(userId, excludeSessionId) {\n    const where = excludeSessionId ? {\n        userId,\n        terminatedAt: null,\n        id: {\n            not: excludeSessionId\n        }\n    } : {\n        userId,\n        terminatedAt: null\n    };\n    await _db__WEBPACK_IMPORTED_MODULE_3__.prisma.userSession.updateMany({\n        where,\n        data: {\n            terminatedAt: new Date()\n        }\n    });\n}\nasync function cleanupExpiredSessions() {\n    const result = await _db__WEBPACK_IMPORTED_MODULE_3__.prisma.userSession.updateMany({\n        where: {\n            expiresAt: {\n                lt: new Date()\n            },\n            terminatedAt: null\n        },\n        data: {\n            terminatedAt: new Date()\n        }\n    });\n    return result.count;\n}\nfunction hasPermission(user, permissionCode) {\n    if (!user.role?.permissions) {\n        return false;\n    }\n    return user.role.permissions.some((p)=>p.code === permissionCode);\n}\nfunction hasAnyPermission(user, permissionCodes) {\n    return permissionCodes.some((code)=>hasPermission(user, code));\n}\nfunction hasAllPermissions(user, permissionCodes) {\n    return permissionCodes.every((code)=>hasPermission(user, code));\n}\nasync function setSessionCookie(sessionToken, expiresAt) {\n    const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_2__.cookies)();\n    cookieStore.set(\"session-token\", sessionToken, {\n        expires: expiresAt,\n        httpOnly: true,\n        secure: \"development\" === \"production\",\n        sameSite:  false ? 0 : \"lax\",\n        path: \"/\"\n    });\n}\nasync function clearSessionCookie() {\n    const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_2__.cookies)();\n    cookieStore.delete(\"session-token\");\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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d2VicGFjazovL2NvbW1pc3NhYmxlLWNybS8uL2xpYi9hdXRoLnRzP2JmN2UiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGJjcnlwdCBmcm9tICdiY3J5cHRqcydcbmltcG9ydCBjcnlwdG8gZnJvbSAnY3J5cHRvJ1xuaW1wb3J0IHsgY29va2llcyB9IGZyb20gJ25leHQvaGVhZGVycydcbmltcG9ydCB7IHByaXNtYSB9IGZyb20gJy4vZGInXG5cbmNvbnN0IE9ORV9EQVlfTVMgPSAyNCAqIDYwICogNjAgKiAxMDAwXG5jb25zdCBTQUxUX1JPVU5EUyA9IDEyXG5cbmZ1bmN0aW9uIHJlc29sdmVTZXNzaW9uRHVyYXRpb25EYXlzKCk6IG51bWJlciB7XG4gIGNvbnN0IHJhdyA9IHByb2Nlc3MuZW52LlNFU1NJT05fRFVSQVRJT05fREFZUyA/PyAnNydcbiAgY29uc3QgcGFyc2VkID0gTnVtYmVyLnBhcnNlSW50KHJhdywgMTApXG5cbiAgaWYgKCFOdW1iZXIuaXNGaW5pdGUocGFyc2VkKSB8fCBwYXJzZWQgPD0gMCkge1xuICAgIGNvbnNvbGUud2FybihgU0VTU0lPTl9EVVJBVElPTl9EQVlTIG11c3QgYmUgYSBwb3NpdGl2ZSBpbnRlZ2VyLCByZWNlaXZlZCBcIiR7cmF3fVwiLiBVc2luZyBkZWZhdWx0OiA3YClcbiAgICByZXR1cm4gN1xuICB9XG5cbiAgcmV0dXJuIHBhcnNlZFxufVxuXG5jb25zdCBTRVNTSU9OX0RVUkFUSU9OX0RBWVMgPSByZXNvbHZlU2Vzc2lvbkR1cmF0aW9uRGF5cygpXG5jb25zdCBTRVNTSU9OX0RVUkFUSU9OX01TID0gU0VTU0lPTl9EVVJBVElPTl9EQVlTICogT05FX0RBWV9NU1xuXG5leHBvcnQgaW50ZXJmYWNlIEF1dGhVc2VyIHtcbiAgaWQ6IHN0cmluZ1xuICB0ZW5hbnRJZDogc3RyaW5nXG4gIGVtYWlsOiBzdHJpbmdcbiAgZmlyc3ROYW1lOiBzdHJpbmdcbiAgbGFzdE5hbWU6IHN0cmluZ1xuICBmdWxsTmFtZTogc3RyaW5nXG4gIHJvbGVJZDogc3RyaW5nIHwgbnVsbFxuICBzdGF0dXM6IHN0cmluZ1xuICByb2xlPzoge1xuICAgIGlkOiBzdHJpbmdcbiAgICBjb2RlOiBzdHJpbmdcbiAgICBuYW1lOiBzdHJpbmdcbiAgICBwZXJtaXNzaW9uczogQXJyYXk8e1xuICAgICAgaWQ6IHN0cmluZ1xuICAgICAgY29kZTogc3RyaW5nXG4gICAgICBuYW1lOiBzdHJpbmdcbiAgICAgIGNhdGVnb3J5OiBzdHJpbmdcbiAgICB9PlxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYXNoUGFzc3dvcmQocGFzc3dvcmQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gIHJldHVybiBiY3J5cHQuaGFzaChwYXNzd29yZCwgU0FMVF9ST1VORFMpXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB2ZXJpZnlQYXNzd29yZChwYXNzd29yZDogc3RyaW5nLCBoYXNoOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgcmV0dXJuIGJjcnlwdC5jb21wYXJlKHBhc3N3b3JkLCBoYXNoKVxufVxuXG5mdW5jdGlvbiBnZW5lcmF0ZU9wYXF1ZVRva2VuKCk6IHN0cmluZyB7XG4gIHJldHVybiBjcnlwdG8ucmFuZG9tQnl0ZXMoMzIpLnRvU3RyaW5nKCdiYXNlNjR1cmwnKVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlVXNlclNlc3Npb24oXG4gIHVzZXJJZDogc3RyaW5nLFxuICB0ZW5hbnRJZDogc3RyaW5nLFxuICBpcEFkZHJlc3M/OiBzdHJpbmcsXG4gIHVzZXJBZ2VudD86IHN0cmluZ1xuKTogUHJvbWlzZTx7IHNlc3Npb25Ub2tlbjogc3RyaW5nOyBzZXNzaW9uSWQ6IHN0cmluZzsgZXhwaXJlc0F0OiBEYXRlIH0+IHtcbiAgY29uc3Qgc2Vzc2lvblRva2VuID0gZ2VuZXJhdGVPcGFxdWVUb2tlbigpXG4gIGNvbnN0IGV4cGlyZXNBdCA9IG5ldyBEYXRlKERhdGUubm93KCkgKyBTRVNTSU9OX0RVUkFUSU9OX01TKVxuXG4gIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBwcmlzbWEudXNlclNlc3Npb24uY3JlYXRlKHtcbiAgICBkYXRhOiB7XG4gICAgICB0ZW5hbnRJZCxcbiAgICAgIHVzZXJJZCxcbiAgICAgIHNlc3Npb25Ub2tlbixcbiAgICAgIGlwQWRkcmVzczogaXBBZGRyZXNzID8/IG51bGwsXG4gICAgICB1c2VyQWdlbnQ6IHVzZXJBZ2VudCA/PyBudWxsLFxuICAgICAgZXhwaXJlc0F0LFxuICAgICAgbGFzdFNlZW5BdDogbmV3IERhdGUoKVxuICAgIH1cbiAgfSlcblxuICByZXR1cm4ge1xuICAgIHNlc3Npb25Ub2tlbixcbiAgICBzZXNzaW9uSWQ6IHNlc3Npb24uaWQsXG4gICAgZXhwaXJlc0F0XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEF1dGhlbnRpY2F0ZWRVc2VyKHNlc3Npb25Ub2tlbj86IHN0cmluZyk6IFByb21pc2U8QXV0aFVzZXIgfCBudWxsPiB7XG4gIGlmICghc2Vzc2lvblRva2VuKSB7XG4gICAgY29uc3QgY29va2llU3RvcmUgPSBhd2FpdCBjb29raWVzKClcbiAgICBzZXNzaW9uVG9rZW4gPSBjb29raWVTdG9yZS5nZXQoJ3Nlc3Npb24tdG9rZW4nKT8udmFsdWVcbiAgfVxuXG4gIGlmICghc2Vzc2lvblRva2VuKSB7XG4gICAgcmV0dXJuIG51bGxcbiAgfVxuXG4gIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBwcmlzbWEudXNlclNlc3Npb24uZmluZEZpcnN0KHtcbiAgICB3aGVyZToge1xuICAgICAgc2Vzc2lvblRva2VuLFxuICAgICAgZXhwaXJlc0F0OiB7IGd0OiBuZXcgRGF0ZSgpIH0sXG4gICAgICB0ZXJtaW5hdGVkQXQ6IG51bGxcbiAgICB9XG4gIH0pXG5cbiAgaWYgKCFzZXNzaW9uKSB7XG4gICAgcmV0dXJuIG51bGxcbiAgfVxuXG4gIGF3YWl0IHByaXNtYS51c2VyU2Vzc2lvbi51cGRhdGUoe1xuICAgIHdoZXJlOiB7IGlkOiBzZXNzaW9uLmlkIH0sXG4gICAgZGF0YTogeyBsYXN0U2VlbkF0OiBuZXcgRGF0ZSgpIH1cbiAgfSlcblxuICBjb25zdCB1c2VyID0gYXdhaXQgcHJpc21hLnVzZXIuZmluZEZpcnN0KHtcbiAgICB3aGVyZToge1xuICAgICAgaWQ6IHNlc3Npb24udXNlcklkLFxuICAgICAgdGVuYW50SWQ6IHNlc3Npb24udGVuYW50SWQsXG4gICAgICBzdGF0dXM6IHsgaW46IFsnQWN0aXZlJywgJ0ludml0ZWQnXSB9XG4gICAgfSxcbiAgICBpbmNsdWRlOiB7XG4gICAgICByb2xlOiB7XG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICBwZXJtaXNzaW9uczoge1xuICAgICAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgICAgICBwZXJtaXNzaW9uOiB0cnVlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9KVxuXG4gIGlmICghdXNlcikge1xuICAgIHJldHVybiBudWxsXG4gIH1cblxuICByZXR1cm4ge1xuICAgIGlkOiB1c2VyLmlkLFxuICAgIHRlbmFudElkOiB1c2VyLnRlbmFudElkLFxuICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxuICAgIGZpcnN0TmFtZTogdXNlci5maXJzdE5hbWUsXG4gICAgbGFzdE5hbWU6IHVzZXIubGFzdE5hbWUsXG4gICAgZnVsbE5hbWU6IHVzZXIuZnVsbE5hbWUsXG4gICAgcm9sZUlkOiB1c2VyLnJvbGVJZCxcbiAgICBzdGF0dXM6IHVzZXIuc3RhdHVzLFxuICAgIHJvbGU6IHVzZXIucm9sZVxuICAgICAgPyB7XG4gICAgICAgICAgaWQ6IHVzZXIucm9sZS5pZCxcbiAgICAgICAgICBjb2RlOiB1c2VyLnJvbGUuY29kZSxcbiAgICAgICAgICBuYW1lOiB1c2VyLnJvbGUubmFtZSxcbiAgICAgICAgICBwZXJtaXNzaW9uczogdXNlci5yb2xlLnBlcm1pc3Npb25zLm1hcChycCA9PiAoe1xuICAgICAgICAgICAgaWQ6IHJwLnBlcm1pc3Npb24uaWQsXG4gICAgICAgICAgICBjb2RlOiBycC5wZXJtaXNzaW9uLmNvZGUsXG4gICAgICAgICAgICBuYW1lOiBycC5wZXJtaXNzaW9uLm5hbWUsXG4gICAgICAgICAgICBjYXRlZ29yeTogcnAucGVybWlzc2lvbi5jYXRlZ29yeVxuICAgICAgICAgIH0pKVxuICAgICAgICB9XG4gICAgICA6IHVuZGVmaW5lZFxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB0ZXJtaW5hdGVTZXNzaW9uKHNlc3Npb25JZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gIGF3YWl0IHByaXNtYS51c2VyU2Vzc2lvbi51cGRhdGUoe1xuICAgIHdoZXJlOiB7IGlkOiBzZXNzaW9uSWQgfSxcbiAgICBkYXRhOiB7IHRlcm1pbmF0ZWRBdDogbmV3IERhdGUoKSB9XG4gIH0pXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB0ZXJtaW5hdGVBbGxVc2VyU2Vzc2lvbnModXNlcklkOiBzdHJpbmcsIGV4Y2x1ZGVTZXNzaW9uSWQ/OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3Qgd2hlcmUgPSBleGNsdWRlU2Vzc2lvbklkXG4gICAgPyB7IHVzZXJJZCwgdGVybWluYXRlZEF0OiBudWxsLCBpZDogeyBub3Q6IGV4Y2x1ZGVTZXNzaW9uSWQgfSB9XG4gICAgOiB7IHVzZXJJZCwgdGVybWluYXRlZEF0OiBudWxsIH1cblxuICBhd2FpdCBwcmlzbWEudXNlclNlc3Npb24udXBkYXRlTWFueSh7XG4gICAgd2hlcmUsXG4gICAgZGF0YTogeyB0ZXJtaW5hdGVkQXQ6IG5ldyBEYXRlKCkgfVxuICB9KVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY2xlYW51cEV4cGlyZWRTZXNzaW9ucygpOiBQcm9taXNlPG51bWJlcj4ge1xuICBjb25zdCByZXN1bHQgPSBhd2FpdCBwcmlzbWEudXNlclNlc3Npb24udXBkYXRlTWFueSh7XG4gICAgd2hlcmU6IHtcbiAgICAgIGV4cGlyZXNBdDogeyBsdDogbmV3IERhdGUoKSB9LFxuICAgICAgdGVybWluYXRlZEF0OiBudWxsXG4gICAgfSxcbiAgICBkYXRhOiB7IHRlcm1pbmF0ZWRBdDogbmV3IERhdGUoKSB9XG4gIH0pXG5cbiAgcmV0dXJuIHJlc3VsdC5jb3VudFxufVxuXG5leHBvcnQgZnVuY3Rpb24gaGFzUGVybWlzc2lvbih1c2VyOiBBdXRoVXNlciwgcGVybWlzc2lvbkNvZGU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICBpZiAoIXVzZXIucm9sZT8ucGVybWlzc2lvbnMpIHtcbiAgICByZXR1cm4gZmFsc2VcbiAgfVxuXG4gIHJldHVybiB1c2VyLnJvbGUucGVybWlzc2lvbnMuc29tZShwID0+IHAuY29kZSA9PT0gcGVybWlzc2lvbkNvZGUpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBoYXNBbnlQZXJtaXNzaW9uKHVzZXI6IEF1dGhVc2VyLCBwZXJtaXNzaW9uQ29kZXM6IHN0cmluZ1tdKTogYm9vbGVhbiB7XG4gIHJldHVybiBwZXJtaXNzaW9uQ29kZXMuc29tZShjb2RlID0+IGhhc1Blcm1pc3Npb24odXNlciwgY29kZSkpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBoYXNBbGxQZXJtaXNzaW9ucyh1c2VyOiBBdXRoVXNlciwgcGVybWlzc2lvbkNvZGVzOiBzdHJpbmdbXSk6IGJvb2xlYW4ge1xuICByZXR1cm4gcGVybWlzc2lvbkNvZGVzLmV2ZXJ5KGNvZGUgPT4gaGFzUGVybWlzc2lvbih1c2VyLCBjb2RlKSlcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNldFNlc3Npb25Db29raWUoc2Vzc2lvblRva2VuOiBzdHJpbmcsIGV4cGlyZXNBdDogRGF0ZSk6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCBjb29raWVTdG9yZSA9IGF3YWl0IGNvb2tpZXMoKVxuICBjb29raWVTdG9yZS5zZXQoJ3Nlc3Npb24tdG9rZW4nLCBzZXNzaW9uVG9rZW4sIHtcbiAgICBleHBpcmVzOiBleHBpcmVzQXQsXG4gICAgaHR0cE9ubHk6IHRydWUsXG4gICAgc2VjdXJlOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nLFxuICAgIHNhbWVTaXRlOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nID8gJ25vbmUnIDogJ2xheCcsXG4gICAgcGF0aDogJy8nXG4gIH0pXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjbGVhclNlc3Npb25Db29raWUoKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IGNvb2tpZVN0b3JlID0gYXdhaXQgY29va2llcygpXG4gIGNvb2tpZVN0b3JlLmRlbGV0ZSgnc2Vzc2lvbi10b2tlbicpXG59XG4iXSwibmFtZXMiOlsiYmNyeXB0IiwiY3J5cHRvIiwiY29va2llcyIsInByaXNtYSIsIk9ORV9EQVlfTVMiLCJTQUxUX1JPVU5EUyIsInJlc29sdmVTZXNzaW9uRHVyYXRpb25EYXlzIiwicmF3IiwicHJvY2VzcyIsImVudiIsIlNFU1NJT05fRFVSQVRJT05fREFZUyIsInBhcnNlZCIsIk51bWJlciIsInBhcnNlSW50IiwiaXNGaW5pdGUiLCJjb25zb2xlIiwid2FybiIsIlNFU1NJT05fRFVSQVRJT05fTVMiLCJoYXNoUGFzc3dvcmQiLCJwYXNzd29yZCIsImhhc2giLCJ2ZXJpZnlQYXNzd29yZCIsImNvbXBhcmUiLCJnZW5lcmF0ZU9wYXF1ZVRva2VuIiwicmFuZG9tQnl0ZXMiLCJ0b1N0cmluZyIsImNyZWF0ZVVzZXJTZXNzaW9uIiwidXNlcklkIiwidGVuYW50SWQiLCJpcEFkZHJlc3MiLCJ1c2VyQWdlbnQiLCJzZXNzaW9uVG9rZW4iLCJleHBpcmVzQXQiLCJEYXRlIiwibm93Iiwic2Vzc2lvbiIsInVzZXJTZXNzaW9uIiwiY3JlYXRlIiwiZGF0YSIsImxhc3RTZWVuQXQiLCJzZXNzaW9uSWQiLCJpZCIsImdldEF1dGhlbnRpY2F0ZWRVc2VyIiwiY29va2llU3RvcmUiLCJnZXQiLCJ2YWx1ZSIsImZpbmRGaXJzdCIsIndoZXJlIiwiZ3QiLCJ0ZXJtaW5hdGVkQXQiLCJ1cGRhdGUiLCJ1c2VyIiwic3RhdHVzIiwiaW4iLCJpbmNsdWRlIiwicm9sZSIsInBlcm1pc3Npb25zIiwicGVybWlzc2lvbiIsImVtYWlsIiwiZmlyc3ROYW1lIiwibGFzdE5hbWUiLCJmdWxsTmFtZSIsInJvbGVJZCIsImNvZGUiLCJuYW1lIiwibWFwIiwicnAiLCJjYXRlZ29yeSIsInVuZGVmaW5lZCIsInRlcm1pbmF0ZVNlc3Npb24iLCJ0ZXJtaW5hdGVBbGxVc2VyU2Vzc2lvbnMiLCJleGNsdWRlU2Vzc2lvbklkIiwibm90IiwidXBkYXRlTWFueSIsImNsZWFudXBFeHBpcmVkU2Vzc2lvbnMiLCJyZXN1bHQiLCJsdCIsImNvdW50IiwiaGFzUGVybWlzc2lvbiIsInBlcm1pc3Npb25Db2RlIiwic29tZSIsInAiLCJoYXNBbnlQZXJtaXNzaW9uIiwicGVybWlzc2lvbkNvZGVzIiwiaGFzQWxsUGVybWlzc2lvbnMiLCJldmVyeSIsInNldFNlc3Npb25Db29raWUiLCJzZXQiLCJleHBpcmVzIiwiaHR0cE9ubHkiLCJzZWN1cmUiLCJzYW1lU2l0ZSIsInBhdGgiLCJjbGVhclNlc3Npb25Db29raWUiLCJkZWxldGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/auth.ts\n");

/***/ }),

/***/ "(rsc)/./lib/db.ts":
/*!*******************!*\
  !*** ./lib/db.ts ***!
  \*******************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   checkDatabaseHealth: () => (/* binding */ checkDatabaseHealth),\n/* harmony export */   disconnect: () => (/* binding */ disconnect),\n/* harmony export */   prisma: () => (/* binding */ prisma),\n/* harmony export */   testConnection: () => (/* binding */ testConnection),\n/* harmony export */   withRetry: () => (/* binding */ withRetry)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nconst globalForPrisma = globalThis;\n// Enhanced Prisma client configuration with connection pooling and retry logic\nconst prisma = globalForPrisma.prisma ?? new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n    log:  true ? [\n        \"query\",\n        \"error\",\n        \"warn\"\n    ] : 0,\n    datasources: {\n        db: {\n            url: process.env.DATABASE_URL\n        }\n    }\n});\nif (true) globalForPrisma.prisma = prisma;\n// Retry mechanism for database operations\nasync function withRetry(operation, maxRetries = 3, delay = 1000) {\n    let lastError = null;\n    for(let attempt = 1; attempt <= maxRetries; attempt++){\n        try {\n            return await operation();\n        } catch (error) {\n            lastError = error instanceof Error ? error : new Error(\"Unknown error\");\n            if (attempt === maxRetries) {\n                throw lastError;\n            }\n            console.warn(`Database operation failed (attempt ${attempt}/${maxRetries}), retrying in ${delay}ms...`, lastError.message);\n            await new Promise((resolve)=>setTimeout(resolve, delay));\n            delay *= 2 // Exponential backoff\n            ;\n        }\n    }\n    throw lastError || new Error(\"Operation failed after all retries\");\n}\n// Connection testing utility\nasync function testConnection() {\n    try {\n        await withRetry(async ()=>{\n            await prisma.$connect();\n        });\n        console.log(\"✅ Database connection successful\");\n        return {\n            status: \"healthy\",\n            timestamp: new Date()\n        };\n    } catch (error) {\n        console.error(\"❌ Database connection failed:\", error);\n        return {\n            status: \"unhealthy\",\n            error: error instanceof Error ? error.message : \"Unknown error\",\n            timestamp: new Date()\n        };\n    }\n}\n// Health check function\nasync function checkDatabaseHealth() {\n    try {\n        await withRetry(async ()=>{\n            await prisma.$queryRaw`SELECT 1`;\n        });\n        return {\n            status: \"healthy\",\n            timestamp: new Date()\n        };\n    } catch (error) {\n        return {\n            status: \"unhealthy\",\n            error: error instanceof Error ? error.message : \"Unknown error\",\n            timestamp: new Date()\n        };\n    }\n}\n// Graceful shutdown\nasync function disconnect() {\n    await prisma.$disconnect();\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZGIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUE2QztBQUU3QyxNQUFNQyxrQkFBa0JDO0FBSXhCLCtFQUErRTtBQUN4RSxNQUFNQyxTQUFTRixnQkFBZ0JFLE1BQU0sSUFBSSxJQUFJSCx3REFBWUEsQ0FBQztJQUMvREksS0FBS0MsS0FBeUIsR0FBZ0I7UUFBQztRQUFTO1FBQVM7S0FBTyxHQUFHLENBQVM7SUFDcEZDLGFBQWE7UUFDWEMsSUFBSTtZQUNGQyxLQUFLSCxRQUFRSSxHQUFHLENBQUNDLFlBQVk7UUFDL0I7SUFDRjtBQUNGLEdBQUU7QUFFRixJQUFJTCxJQUF5QixFQUFjSixnQkFBZ0JFLE1BQU0sR0FBR0E7QUFFcEUsMENBQTBDO0FBQ25DLGVBQWVRLFVBQ3BCQyxTQUEyQixFQUMzQkMsYUFBcUIsQ0FBQyxFQUN0QkMsUUFBZ0IsSUFBSTtJQUVwQixJQUFJQyxZQUEwQjtJQUU5QixJQUFLLElBQUlDLFVBQVUsR0FBR0EsV0FBV0gsWUFBWUcsVUFBVztRQUN0RCxJQUFJO1lBQ0YsT0FBTyxNQUFNSjtRQUNmLEVBQUUsT0FBT0ssT0FBTztZQUNkRixZQUFZRSxpQkFBaUJDLFFBQVFELFFBQVEsSUFBSUMsTUFBTTtZQUV2RCxJQUFJRixZQUFZSCxZQUFZO2dCQUMxQixNQUFNRTtZQUNSO1lBRUFJLFFBQVFDLElBQUksQ0FBQyxDQUFDLG1DQUFtQyxFQUFFSixRQUFRLENBQUMsRUFBRUgsV0FBVyxlQUFlLEVBQUVDLE1BQU0sS0FBSyxDQUFDLEVBQUVDLFVBQVVNLE9BQU87WUFDekgsTUFBTSxJQUFJQyxRQUFRQyxDQUFBQSxVQUFXQyxXQUFXRCxTQUFTVDtZQUNqREEsU0FBUyxFQUFFLHNCQUFzQjs7UUFDbkM7SUFDRjtJQUVBLE1BQU1DLGFBQWEsSUFBSUcsTUFBTTtBQUMvQjtBQUVBLDZCQUE2QjtBQUN0QixlQUFlTztJQUNwQixJQUFJO1FBQ0YsTUFBTWQsVUFBVTtZQUNkLE1BQU1SLE9BQU91QixRQUFRO1FBQ3ZCO1FBQ0FQLFFBQVFmLEdBQUcsQ0FBQztRQUNaLE9BQU87WUFBRXVCLFFBQVE7WUFBV0MsV0FBVyxJQUFJQztRQUFPO0lBQ3BELEVBQUUsT0FBT1osT0FBTztRQUNkRSxRQUFRRixLQUFLLENBQUMsaUNBQWlDQTtRQUMvQyxPQUFPO1lBQUVVLFFBQVE7WUFBYVYsT0FBT0EsaUJBQWlCQyxRQUFRRCxNQUFNSSxPQUFPLEdBQUc7WUFBaUJPLFdBQVcsSUFBSUM7UUFBTztJQUN2SDtBQUNGO0FBRUEsd0JBQXdCO0FBQ2pCLGVBQWVDO0lBQ3BCLElBQUk7UUFDRixNQUFNbkIsVUFBVTtZQUNkLE1BQU1SLE9BQU80QixTQUFTLENBQUMsUUFBUSxDQUFDO1FBQ2xDO1FBQ0EsT0FBTztZQUFFSixRQUFRO1lBQVdDLFdBQVcsSUFBSUM7UUFBTztJQUNwRCxFQUFFLE9BQU9aLE9BQU87UUFDZCxPQUFPO1lBQUVVLFFBQVE7WUFBYVYsT0FBT0EsaUJBQWlCQyxRQUFRRCxNQUFNSSxPQUFPLEdBQUc7WUFBaUJPLFdBQVcsSUFBSUM7UUFBTztJQUN2SDtBQUNGO0FBRUEsb0JBQW9CO0FBQ2IsZUFBZUc7SUFDcEIsTUFBTTdCLE9BQU84QixXQUFXO0FBQzFCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY29tbWlzc2FibGUtY3JtLy4vbGliL2RiLnRzPzFkZjAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUHJpc21hQ2xpZW50IH0gZnJvbSAnQHByaXNtYS9jbGllbnQnXG5cbmNvbnN0IGdsb2JhbEZvclByaXNtYSA9IGdsb2JhbFRoaXMgYXMgdW5rbm93biBhcyB7XG4gIHByaXNtYTogUHJpc21hQ2xpZW50IHwgdW5kZWZpbmVkXG59XG5cbi8vIEVuaGFuY2VkIFByaXNtYSBjbGllbnQgY29uZmlndXJhdGlvbiB3aXRoIGNvbm5lY3Rpb24gcG9vbGluZyBhbmQgcmV0cnkgbG9naWNcbmV4cG9ydCBjb25zdCBwcmlzbWEgPSBnbG9iYWxGb3JQcmlzbWEucHJpc21hID8/IG5ldyBQcmlzbWFDbGllbnQoe1xuICBsb2c6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnID8gWydxdWVyeScsICdlcnJvcicsICd3YXJuJ10gOiBbJ2Vycm9yJ10sXG4gIGRhdGFzb3VyY2VzOiB7XG4gICAgZGI6IHtcbiAgICAgIHVybDogcHJvY2Vzcy5lbnYuREFUQUJBU0VfVVJMLFxuICAgIH0sXG4gIH0sXG59KVxuXG5pZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgZ2xvYmFsRm9yUHJpc21hLnByaXNtYSA9IHByaXNtYVxuXG4vLyBSZXRyeSBtZWNoYW5pc20gZm9yIGRhdGFiYXNlIG9wZXJhdGlvbnNcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB3aXRoUmV0cnk8VD4oXG4gIG9wZXJhdGlvbjogKCkgPT4gUHJvbWlzZTxUPixcbiAgbWF4UmV0cmllczogbnVtYmVyID0gMyxcbiAgZGVsYXk6IG51bWJlciA9IDEwMDBcbik6IFByb21pc2U8VD4ge1xuICBsZXQgbGFzdEVycm9yOiBFcnJvciB8IG51bGwgPSBudWxsXG4gIFxuICBmb3IgKGxldCBhdHRlbXB0ID0gMTsgYXR0ZW1wdCA8PSBtYXhSZXRyaWVzOyBhdHRlbXB0KyspIHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGF3YWl0IG9wZXJhdGlvbigpXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxhc3RFcnJvciA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvciA6IG5ldyBFcnJvcignVW5rbm93biBlcnJvcicpXG4gICAgICBcbiAgICAgIGlmIChhdHRlbXB0ID09PSBtYXhSZXRyaWVzKSB7XG4gICAgICAgIHRocm93IGxhc3RFcnJvclxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zb2xlLndhcm4oYERhdGFiYXNlIG9wZXJhdGlvbiBmYWlsZWQgKGF0dGVtcHQgJHthdHRlbXB0fS8ke21heFJldHJpZXN9KSwgcmV0cnlpbmcgaW4gJHtkZWxheX1tcy4uLmAsIGxhc3RFcnJvci5tZXNzYWdlKVxuICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIGRlbGF5KSlcbiAgICAgIGRlbGF5ICo9IDIgLy8gRXhwb25lbnRpYWwgYmFja29mZlxuICAgIH1cbiAgfVxuICBcbiAgdGhyb3cgbGFzdEVycm9yIHx8IG5ldyBFcnJvcignT3BlcmF0aW9uIGZhaWxlZCBhZnRlciBhbGwgcmV0cmllcycpXG59XG5cbi8vIENvbm5lY3Rpb24gdGVzdGluZyB1dGlsaXR5XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdGVzdENvbm5lY3Rpb24oKSB7XG4gIHRyeSB7XG4gICAgYXdhaXQgd2l0aFJldHJ5KGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IHByaXNtYS4kY29ubmVjdCgpXG4gICAgfSlcbiAgICBjb25zb2xlLmxvZygn4pyFIERhdGFiYXNlIGNvbm5lY3Rpb24gc3VjY2Vzc2Z1bCcpXG4gICAgcmV0dXJuIHsgc3RhdHVzOiAnaGVhbHRoeScsIHRpbWVzdGFtcDogbmV3IERhdGUoKSB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcign4p2MIERhdGFiYXNlIGNvbm5lY3Rpb24gZmFpbGVkOicsIGVycm9yKVxuICAgIHJldHVybiB7IHN0YXR1czogJ3VuaGVhbHRoeScsIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJywgdGltZXN0YW1wOiBuZXcgRGF0ZSgpIH1cbiAgfVxufVxuXG4vLyBIZWFsdGggY2hlY2sgZnVuY3Rpb25cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjaGVja0RhdGFiYXNlSGVhbHRoKCkge1xuICB0cnkge1xuICAgIGF3YWl0IHdpdGhSZXRyeShhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCBwcmlzbWEuJHF1ZXJ5UmF3YFNFTEVDVCAxYFxuICAgIH0pXG4gICAgcmV0dXJuIHsgc3RhdHVzOiAnaGVhbHRoeScsIHRpbWVzdGFtcDogbmV3IERhdGUoKSB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHsgc3RhdHVzOiAndW5oZWFsdGh5JywgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLCB0aW1lc3RhbXA6IG5ldyBEYXRlKCkgfVxuICB9XG59XG5cbi8vIEdyYWNlZnVsIHNodXRkb3duXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGlzY29ubmVjdCgpIHtcbiAgYXdhaXQgcHJpc21hLiRkaXNjb25uZWN0KClcbn1cbiJdLCJuYW1lcyI6WyJQcmlzbWFDbGllbnQiLCJnbG9iYWxGb3JQcmlzbWEiLCJnbG9iYWxUaGlzIiwicHJpc21hIiwibG9nIiwicHJvY2VzcyIsImRhdGFzb3VyY2VzIiwiZGIiLCJ1cmwiLCJlbnYiLCJEQVRBQkFTRV9VUkwiLCJ3aXRoUmV0cnkiLCJvcGVyYXRpb24iLCJtYXhSZXRyaWVzIiwiZGVsYXkiLCJsYXN0RXJyb3IiLCJhdHRlbXB0IiwiZXJyb3IiLCJFcnJvciIsImNvbnNvbGUiLCJ3YXJuIiwibWVzc2FnZSIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsInRlc3RDb25uZWN0aW9uIiwiJGNvbm5lY3QiLCJzdGF0dXMiLCJ0aW1lc3RhbXAiLCJEYXRlIiwiY2hlY2tEYXRhYmFzZUhlYWx0aCIsIiRxdWVyeVJhdyIsImRpc2Nvbm5lY3QiLCIkZGlzY29ubmVjdCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/db.ts\n");

/***/ }),

/***/ "(rsc)/./lib/validation.ts":
/*!***************************!*\
  !*** ./lib/validation.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   US_STATE_CODES: () => (/* binding */ US_STATE_CODES),\n/* harmony export */   VALIDATION_PATTERNS: () => (/* binding */ VALIDATION_PATTERNS),\n/* harmony export */   createValidationErrorResponse: () => (/* binding */ createValidationErrorResponse),\n/* harmony export */   formatPhoneNumber: () => (/* binding */ formatPhoneNumber),\n/* harmony export */   normalizeEmail: () => (/* binding */ normalizeEmail),\n/* harmony export */   normalizeState: () => (/* binding */ normalizeState),\n/* harmony export */   validateAccountData: () => (/* binding */ validateAccountData),\n/* harmony export */   validateContactData: () => (/* binding */ validateContactData),\n/* harmony export */   validateEmail: () => (/* binding */ validateEmail),\n/* harmony export */   validatePhone: () => (/* binding */ validatePhone),\n/* harmony export */   validateRequiredString: () => (/* binding */ validateRequiredString),\n/* harmony export */   validateState: () => (/* binding */ validateState),\n/* harmony export */   validateUrl: () => (/* binding */ validateUrl),\n/* harmony export */   validateZip: () => (/* binding */ validateZip)\n/* harmony export */ });\n/**\r\n * Server-side data validation utilities\r\n * Implements contract requirements for field validation\r\n */ // Validation patterns per contract requirements\nconst VALIDATION_PATTERNS = {\n    // Email format: proper@email.com\n    email: /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/,\n    // Phone format: xxx-xxx-xxxx\n    phone: /^\\d{3}-\\d{3}-\\d{4}$/,\n    // URL format: https://website.com\n    url: /^https?:\\/\\/(www\\.)?[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}(\\/.*)?$/,\n    // State: 2-letter codes only\n    state: /^[A-Z]{2}$/,\n    // Zip: Maximum 12 characters\n    zip: /^.{1,12}$/\n};\n// US State codes for validation\nconst US_STATE_CODES = [\n    \"AL\",\n    \"AK\",\n    \"AZ\",\n    \"AR\",\n    \"CA\",\n    \"CO\",\n    \"CT\",\n    \"DE\",\n    \"FL\",\n    \"GA\",\n    \"HI\",\n    \"ID\",\n    \"IL\",\n    \"IN\",\n    \"IA\",\n    \"KS\",\n    \"KY\",\n    \"LA\",\n    \"ME\",\n    \"MD\",\n    \"MA\",\n    \"MI\",\n    \"MN\",\n    \"MS\",\n    \"MO\",\n    \"MT\",\n    \"NE\",\n    \"NV\",\n    \"NH\",\n    \"NJ\",\n    \"NM\",\n    \"NY\",\n    \"NC\",\n    \"ND\",\n    \"OH\",\n    \"OK\",\n    \"OR\",\n    \"PA\",\n    \"RI\",\n    \"SC\",\n    \"SD\",\n    \"TN\",\n    \"TX\",\n    \"UT\",\n    \"VT\",\n    \"VA\",\n    \"WA\",\n    \"WV\",\n    \"WI\",\n    \"WY\",\n    \"DC\" // Washington DC\n];\n/**\r\n * Validates email format according to contract requirements\r\n */ function validateEmail(email) {\n    const errors = [];\n    if (!email) {\n        return {\n            isValid: true,\n            errors: []\n        } // Optional field\n        ;\n    }\n    if (typeof email !== \"string\") {\n        errors.push({\n            field: \"email\",\n            message: \"Email must be a string\",\n            value: email\n        });\n    } else if (!VALIDATION_PATTERNS.email.test(email)) {\n        errors.push({\n            field: \"email\",\n            message: \"Email must be in format: proper@email.com\",\n            value: email\n        });\n    }\n    return {\n        isValid: errors.length === 0,\n        errors\n    };\n}\n/**\r\n * Validates phone format according to contract requirements (xxx-xxx-xxxx)\r\n */ function validatePhone(phone, fieldName = \"phone\") {\n    const errors = [];\n    if (!phone) {\n        return {\n            isValid: true,\n            errors: []\n        } // Optional field\n        ;\n    }\n    if (typeof phone !== \"string\") {\n        errors.push({\n            field: fieldName,\n            message: \"Phone must be a string\",\n            value: phone\n        });\n    } else if (!VALIDATION_PATTERNS.phone.test(phone)) {\n        errors.push({\n            field: fieldName,\n            message: \"Phone must be in format: xxx-xxx-xxxx\",\n            value: phone\n        });\n    }\n    return {\n        isValid: errors.length === 0,\n        errors\n    };\n}\n/**\r\n * Validates URL format according to contract requirements\r\n */ function validateUrl(url, fieldName = \"url\") {\n    const errors = [];\n    if (!url) {\n        return {\n            isValid: true,\n            errors: []\n        } // Optional field\n        ;\n    }\n    if (typeof url !== \"string\") {\n        errors.push({\n            field: fieldName,\n            message: \"URL must be a string\",\n            value: url\n        });\n    } else if (!VALIDATION_PATTERNS.url.test(url)) {\n        errors.push({\n            field: fieldName,\n            message: \"URL must be in format: https://website.com\",\n            value: url\n        });\n    }\n    return {\n        isValid: errors.length === 0,\n        errors\n    };\n}\n/**\r\n * Validates state code according to contract requirements (2-letter codes only)\r\n */ function validateState(state, fieldName = \"state\") {\n    const errors = [];\n    if (!state) {\n        return {\n            isValid: true,\n            errors: []\n        } // Optional field\n        ;\n    }\n    if (typeof state !== \"string\") {\n        errors.push({\n            field: fieldName,\n            message: \"State must be a string\",\n            value: state\n        });\n    } else if (!VALIDATION_PATTERNS.state.test(state)) {\n        errors.push({\n            field: fieldName,\n            message: \"State must be a 2-letter code (e.g., CA, NY, TX)\",\n            value: state\n        });\n    } else if (!US_STATE_CODES.includes(state)) {\n        errors.push({\n            field: fieldName,\n            message: \"State must be a valid US state code\",\n            value: state\n        });\n    }\n    return {\n        isValid: errors.length === 0,\n        errors\n    };\n}\n/**\r\n * Validates zip code according to contract requirements (maximum 12 characters)\r\n */ function validateZip(zip, fieldName = \"zip\") {\n    const errors = [];\n    if (!zip) {\n        return {\n            isValid: true,\n            errors: []\n        } // Optional field\n        ;\n    }\n    if (typeof zip !== \"string\") {\n        errors.push({\n            field: fieldName,\n            message: \"Zip code must be a string\",\n            value: zip\n        });\n    } else if (!VALIDATION_PATTERNS.zip.test(zip)) {\n        errors.push({\n            field: fieldName,\n            message: \"Zip code must be maximum 12 characters\",\n            value: zip\n        });\n    }\n    return {\n        isValid: errors.length === 0,\n        errors\n    };\n}\n/**\r\n * Validates required string fields\r\n */ function validateRequiredString(value, fieldName) {\n    const errors = [];\n    if (!value || typeof value === \"string\" && value.trim().length === 0) {\n        errors.push({\n            field: fieldName,\n            message: `${fieldName} is required`,\n            value\n        });\n    } else if (typeof value !== \"string\") {\n        errors.push({\n            field: fieldName,\n            message: `${fieldName} must be a string`,\n            value\n        });\n    }\n    return {\n        isValid: errors.length === 0,\n        errors\n    };\n}\n/**\r\n * Validates account data according to contract requirements\r\n */ function validateAccountData(data) {\n    const errors = [];\n    // Required fields\n    const accountNameResult = validateRequiredString(data.accountName, \"Account Name\");\n    errors.push(...accountNameResult.errors);\n    const accountTypeResult = validateRequiredString(data.accountTypeId, \"Account Type\");\n    errors.push(...accountTypeResult.errors);\n    // Optional fields with format validation\n    if (data.websiteUrl) {\n        const urlResult = validateUrl(data.websiteUrl, \"Website URL\");\n        errors.push(...urlResult.errors);\n    }\n    // Address validation\n    if (data.shippingAddress) {\n        const shippingStateResult = validateState(data.shippingAddress.state, \"Shipping State\");\n        errors.push(...shippingStateResult.errors);\n        const shippingZipResult = validateZip(data.shippingAddress.postalCode, \"Shipping Zip\");\n        errors.push(...shippingZipResult.errors);\n    }\n    if (data.billingAddress) {\n        const billingStateResult = validateState(data.billingAddress.state, \"Billing State\");\n        errors.push(...billingStateResult.errors);\n        const billingZipResult = validateZip(data.billingAddress.postalCode, \"Billing Zip\");\n        errors.push(...billingZipResult.errors);\n    }\n    return {\n        isValid: errors.length === 0,\n        errors\n    };\n}\n/**\r\n * Validates contact data according to contract requirements\r\n */ function validateContactData(data) {\n    const errors = [];\n    // Required fields\n    const firstNameResult = validateRequiredString(data.firstName, \"First Name\");\n    errors.push(...firstNameResult.errors);\n    const lastNameResult = validateRequiredString(data.lastName, \"Last Name\");\n    errors.push(...lastNameResult.errors);\n    const accountIdResult = validateRequiredString(data.accountId, \"Account\");\n    errors.push(...accountIdResult.errors);\n    // Optional fields with format validation\n    if (data.emailAddress) {\n        const emailResult = validateEmail(data.emailAddress);\n        errors.push(...emailResult.errors);\n    }\n    if (data.workPhone) {\n        const workPhoneResult = validatePhone(data.workPhone, \"Work Phone\");\n        errors.push(...workPhoneResult.errors);\n    }\n    if (data.mobilePhone) {\n        const mobilePhoneResult = validatePhone(data.mobilePhone, \"Mobile Phone\");\n        errors.push(...mobilePhoneResult.errors);\n    }\n    return {\n        isValid: errors.length === 0,\n        errors\n    };\n}\n/**\r\n * Formats phone number to xxx-xxx-xxxx format\r\n */ function formatPhoneNumber(phone) {\n    if (!phone) return \"\";\n    // Remove all non-digit characters\n    const digits = phone.replace(/\\D/g, \"\");\n    // Format as xxx-xxx-xxxx\n    if (digits.length === 10) {\n        return `${digits.slice(0, 3)}-${digits.slice(3, 6)}-${digits.slice(6)}`;\n    }\n    return phone // Return original if not 10 digits\n    ;\n}\n/**\r\n * Normalizes email address (lowercase, trim)\r\n */ function normalizeEmail(email) {\n    if (!email) return \"\";\n    return email.toLowerCase().trim();\n}\n/**\r\n * Normalizes state code (uppercase, trim)\r\n */ function normalizeState(state) {\n    if (!state) return \"\";\n    return state.toUpperCase().trim();\n}\n/**\r\n * Creates a standardized validation error response\r\n */ function createValidationErrorResponse(errors) {\n    return new Response(JSON.stringify({\n        error: \"Validation failed\",\n        details: errors\n    }), {\n        status: 400,\n        headers: {\n            \"Content-Type\": \"application/json\"\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SXFELFNBQ1RDLEtBQUtDLFNBQVMsQ0FBQztRQUNiQyxPQUFPO1FBQ1BDLFNBQVN6RDtJQUNYLElBQ0E7UUFDRTBELFFBQVE7UUFDUkMsU0FBUztZQUFFLGdCQUFnQjtRQUFtQjtJQUNoRDtBQUVKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY29tbWlzc2FibGUtY3JtLy4vbGliL3ZhbGlkYXRpb24udHM/NTBhYyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogU2VydmVyLXNpZGUgZGF0YSB2YWxpZGF0aW9uIHV0aWxpdGllc1xyXG4gKiBJbXBsZW1lbnRzIGNvbnRyYWN0IHJlcXVpcmVtZW50cyBmb3IgZmllbGQgdmFsaWRhdGlvblxyXG4gKi9cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgVmFsaWRhdGlvbkVycm9yIHtcclxuICBmaWVsZDogc3RyaW5nXHJcbiAgbWVzc2FnZTogc3RyaW5nXHJcbiAgdmFsdWU/OiBhbnlcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBWYWxpZGF0aW9uUmVzdWx0IHtcclxuICBpc1ZhbGlkOiBib29sZWFuXHJcbiAgZXJyb3JzOiBWYWxpZGF0aW9uRXJyb3JbXVxyXG59XHJcblxyXG4vLyBWYWxpZGF0aW9uIHBhdHRlcm5zIHBlciBjb250cmFjdCByZXF1aXJlbWVudHNcclxuZXhwb3J0IGNvbnN0IFZBTElEQVRJT05fUEFUVEVSTlMgPSB7XHJcbiAgLy8gRW1haWwgZm9ybWF0OiBwcm9wZXJAZW1haWwuY29tXHJcbiAgZW1haWw6IC9eW2EtekEtWjAtOS5fJSstXStAW2EtekEtWjAtOS4tXStcXC5bYS16QS1aXXsyLH0kLyxcclxuICBcclxuICAvLyBQaG9uZSBmb3JtYXQ6IHh4eC14eHgteHh4eFxyXG4gIHBob25lOiAvXlxcZHszfS1cXGR7M30tXFxkezR9JC8sXHJcbiAgXHJcbiAgLy8gVVJMIGZvcm1hdDogaHR0cHM6Ly93ZWJzaXRlLmNvbVxyXG4gIHVybDogL15odHRwcz86XFwvXFwvKHd3d1xcLik/W2EtekEtWjAtOS4tXStcXC5bYS16QS1aXXsyLH0oXFwvLiopPyQvLFxyXG4gIFxyXG4gIC8vIFN0YXRlOiAyLWxldHRlciBjb2RlcyBvbmx5XHJcbiAgc3RhdGU6IC9eW0EtWl17Mn0kLyxcclxuICBcclxuICAvLyBaaXA6IE1heGltdW0gMTIgY2hhcmFjdGVyc1xyXG4gIHppcDogL14uezEsMTJ9JC9cclxufSBhcyBjb25zdFxyXG5cclxuLy8gVVMgU3RhdGUgY29kZXMgZm9yIHZhbGlkYXRpb25cclxuZXhwb3J0IGNvbnN0IFVTX1NUQVRFX0NPREVTID0gW1xyXG4gICdBTCcsICdBSycsICdBWicsICdBUicsICdDQScsICdDTycsICdDVCcsICdERScsICdGTCcsICdHQScsXHJcbiAgJ0hJJywgJ0lEJywgJ0lMJywgJ0lOJywgJ0lBJywgJ0tTJywgJ0tZJywgJ0xBJywgJ01FJywgJ01EJyxcclxuICAnTUEnLCAnTUknLCAnTU4nLCAnTVMnLCAnTU8nLCAnTVQnLCAnTkUnLCAnTlYnLCAnTkgnLCAnTkonLFxyXG4gICdOTScsICdOWScsICdOQycsICdORCcsICdPSCcsICdPSycsICdPUicsICdQQScsICdSSScsICdTQycsXHJcbiAgJ1NEJywgJ1ROJywgJ1RYJywgJ1VUJywgJ1ZUJywgJ1ZBJywgJ1dBJywgJ1dWJywgJ1dJJywgJ1dZJyxcclxuICAnREMnIC8vIFdhc2hpbmd0b24gRENcclxuXSBhcyBjb25zdFxyXG5cclxuLyoqXHJcbiAqIFZhbGlkYXRlcyBlbWFpbCBmb3JtYXQgYWNjb3JkaW5nIHRvIGNvbnRyYWN0IHJlcXVpcmVtZW50c1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlRW1haWwoZW1haWw6IHN0cmluZyB8IG51bGwgfCB1bmRlZmluZWQpOiBWYWxpZGF0aW9uUmVzdWx0IHtcclxuICBjb25zdCBlcnJvcnM6IFZhbGlkYXRpb25FcnJvcltdID0gW11cclxuICBcclxuICBpZiAoIWVtYWlsKSB7XHJcbiAgICByZXR1cm4geyBpc1ZhbGlkOiB0cnVlLCBlcnJvcnM6IFtdIH0gLy8gT3B0aW9uYWwgZmllbGRcclxuICB9XHJcbiAgXHJcbiAgaWYgKHR5cGVvZiBlbWFpbCAhPT0gJ3N0cmluZycpIHtcclxuICAgIGVycm9ycy5wdXNoKHtcclxuICAgICAgZmllbGQ6ICdlbWFpbCcsXHJcbiAgICAgIG1lc3NhZ2U6ICdFbWFpbCBtdXN0IGJlIGEgc3RyaW5nJyxcclxuICAgICAgdmFsdWU6IGVtYWlsXHJcbiAgICB9KVxyXG4gIH0gZWxzZSBpZiAoIVZBTElEQVRJT05fUEFUVEVSTlMuZW1haWwudGVzdChlbWFpbCkpIHtcclxuICAgIGVycm9ycy5wdXNoKHtcclxuICAgICAgZmllbGQ6ICdlbWFpbCcsXHJcbiAgICAgIG1lc3NhZ2U6ICdFbWFpbCBtdXN0IGJlIGluIGZvcm1hdDogcHJvcGVyQGVtYWlsLmNvbScsXHJcbiAgICAgIHZhbHVlOiBlbWFpbFxyXG4gICAgfSlcclxuICB9XHJcbiAgXHJcbiAgcmV0dXJuIHtcclxuICAgIGlzVmFsaWQ6IGVycm9ycy5sZW5ndGggPT09IDAsXHJcbiAgICBlcnJvcnNcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBWYWxpZGF0ZXMgcGhvbmUgZm9ybWF0IGFjY29yZGluZyB0byBjb250cmFjdCByZXF1aXJlbWVudHMgKHh4eC14eHgteHh4eClcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZVBob25lKHBob25lOiBzdHJpbmcgfCBudWxsIHwgdW5kZWZpbmVkLCBmaWVsZE5hbWU6IHN0cmluZyA9ICdwaG9uZScpOiBWYWxpZGF0aW9uUmVzdWx0IHtcclxuICBjb25zdCBlcnJvcnM6IFZhbGlkYXRpb25FcnJvcltdID0gW11cclxuICBcclxuICBpZiAoIXBob25lKSB7XHJcbiAgICByZXR1cm4geyBpc1ZhbGlkOiB0cnVlLCBlcnJvcnM6IFtdIH0gLy8gT3B0aW9uYWwgZmllbGRcclxuICB9XHJcbiAgXHJcbiAgaWYgKHR5cGVvZiBwaG9uZSAhPT0gJ3N0cmluZycpIHtcclxuICAgIGVycm9ycy5wdXNoKHtcclxuICAgICAgZmllbGQ6IGZpZWxkTmFtZSxcclxuICAgICAgbWVzc2FnZTogJ1Bob25lIG11c3QgYmUgYSBzdHJpbmcnLFxyXG4gICAgICB2YWx1ZTogcGhvbmVcclxuICAgIH0pXHJcbiAgfSBlbHNlIGlmICghVkFMSURBVElPTl9QQVRURVJOUy5waG9uZS50ZXN0KHBob25lKSkge1xyXG4gICAgZXJyb3JzLnB1c2goe1xyXG4gICAgICBmaWVsZDogZmllbGROYW1lLFxyXG4gICAgICBtZXNzYWdlOiAnUGhvbmUgbXVzdCBiZSBpbiBmb3JtYXQ6IHh4eC14eHgteHh4eCcsXHJcbiAgICAgIHZhbHVlOiBwaG9uZVxyXG4gICAgfSlcclxuICB9XHJcbiAgXHJcbiAgcmV0dXJuIHtcclxuICAgIGlzVmFsaWQ6IGVycm9ycy5sZW5ndGggPT09IDAsXHJcbiAgICBlcnJvcnNcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBWYWxpZGF0ZXMgVVJMIGZvcm1hdCBhY2NvcmRpbmcgdG8gY29udHJhY3QgcmVxdWlyZW1lbnRzXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVVcmwodXJsOiBzdHJpbmcgfCBudWxsIHwgdW5kZWZpbmVkLCBmaWVsZE5hbWU6IHN0cmluZyA9ICd1cmwnKTogVmFsaWRhdGlvblJlc3VsdCB7XHJcbiAgY29uc3QgZXJyb3JzOiBWYWxpZGF0aW9uRXJyb3JbXSA9IFtdXHJcbiAgXHJcbiAgaWYgKCF1cmwpIHtcclxuICAgIHJldHVybiB7IGlzVmFsaWQ6IHRydWUsIGVycm9yczogW10gfSAvLyBPcHRpb25hbCBmaWVsZFxyXG4gIH1cclxuICBcclxuICBpZiAodHlwZW9mIHVybCAhPT0gJ3N0cmluZycpIHtcclxuICAgIGVycm9ycy5wdXNoKHtcclxuICAgICAgZmllbGQ6IGZpZWxkTmFtZSxcclxuICAgICAgbWVzc2FnZTogJ1VSTCBtdXN0IGJlIGEgc3RyaW5nJyxcclxuICAgICAgdmFsdWU6IHVybFxyXG4gICAgfSlcclxuICB9IGVsc2UgaWYgKCFWQUxJREFUSU9OX1BBVFRFUk5TLnVybC50ZXN0KHVybCkpIHtcclxuICAgIGVycm9ycy5wdXNoKHtcclxuICAgICAgZmllbGQ6IGZpZWxkTmFtZSxcclxuICAgICAgbWVzc2FnZTogJ1VSTCBtdXN0IGJlIGluIGZvcm1hdDogaHR0cHM6Ly93ZWJzaXRlLmNvbScsXHJcbiAgICAgIHZhbHVlOiB1cmxcclxuICAgIH0pXHJcbiAgfVxyXG4gIFxyXG4gIHJldHVybiB7XHJcbiAgICBpc1ZhbGlkOiBlcnJvcnMubGVuZ3RoID09PSAwLFxyXG4gICAgZXJyb3JzXHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogVmFsaWRhdGVzIHN0YXRlIGNvZGUgYWNjb3JkaW5nIHRvIGNvbnRyYWN0IHJlcXVpcmVtZW50cyAoMi1sZXR0ZXIgY29kZXMgb25seSlcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZVN0YXRlKHN0YXRlOiBzdHJpbmcgfCBudWxsIHwgdW5kZWZpbmVkLCBmaWVsZE5hbWU6IHN0cmluZyA9ICdzdGF0ZScpOiBWYWxpZGF0aW9uUmVzdWx0IHtcclxuICBjb25zdCBlcnJvcnM6IFZhbGlkYXRpb25FcnJvcltdID0gW11cclxuICBcclxuICBpZiAoIXN0YXRlKSB7XHJcbiAgICByZXR1cm4geyBpc1ZhbGlkOiB0cnVlLCBlcnJvcnM6IFtdIH0gLy8gT3B0aW9uYWwgZmllbGRcclxuICB9XHJcbiAgXHJcbiAgaWYgKHR5cGVvZiBzdGF0ZSAhPT0gJ3N0cmluZycpIHtcclxuICAgIGVycm9ycy5wdXNoKHtcclxuICAgICAgZmllbGQ6IGZpZWxkTmFtZSxcclxuICAgICAgbWVzc2FnZTogJ1N0YXRlIG11c3QgYmUgYSBzdHJpbmcnLFxyXG4gICAgICB2YWx1ZTogc3RhdGVcclxuICAgIH0pXHJcbiAgfSBlbHNlIGlmICghVkFMSURBVElPTl9QQVRURVJOUy5zdGF0ZS50ZXN0KHN0YXRlKSkge1xyXG4gICAgZXJyb3JzLnB1c2goe1xyXG4gICAgICBmaWVsZDogZmllbGROYW1lLFxyXG4gICAgICBtZXNzYWdlOiAnU3RhdGUgbXVzdCBiZSBhIDItbGV0dGVyIGNvZGUgKGUuZy4sIENBLCBOWSwgVFgpJyxcclxuICAgICAgdmFsdWU6IHN0YXRlXHJcbiAgICB9KVxyXG4gIH0gZWxzZSBpZiAoIVVTX1NUQVRFX0NPREVTLmluY2x1ZGVzKHN0YXRlIGFzIGFueSkpIHtcclxuICAgIGVycm9ycy5wdXNoKHtcclxuICAgICAgZmllbGQ6IGZpZWxkTmFtZSxcclxuICAgICAgbWVzc2FnZTogJ1N0YXRlIG11c3QgYmUgYSB2YWxpZCBVUyBzdGF0ZSBjb2RlJyxcclxuICAgICAgdmFsdWU6IHN0YXRlXHJcbiAgICB9KVxyXG4gIH1cclxuICBcclxuICByZXR1cm4ge1xyXG4gICAgaXNWYWxpZDogZXJyb3JzLmxlbmd0aCA9PT0gMCxcclxuICAgIGVycm9yc1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFZhbGlkYXRlcyB6aXAgY29kZSBhY2NvcmRpbmcgdG8gY29udHJhY3QgcmVxdWlyZW1lbnRzIChtYXhpbXVtIDEyIGNoYXJhY3RlcnMpXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVaaXAoemlwOiBzdHJpbmcgfCBudWxsIHwgdW5kZWZpbmVkLCBmaWVsZE5hbWU6IHN0cmluZyA9ICd6aXAnKTogVmFsaWRhdGlvblJlc3VsdCB7XHJcbiAgY29uc3QgZXJyb3JzOiBWYWxpZGF0aW9uRXJyb3JbXSA9IFtdXHJcbiAgXHJcbiAgaWYgKCF6aXApIHtcclxuICAgIHJldHVybiB7IGlzVmFsaWQ6IHRydWUsIGVycm9yczogW10gfSAvLyBPcHRpb25hbCBmaWVsZFxyXG4gIH1cclxuICBcclxuICBpZiAodHlwZW9mIHppcCAhPT0gJ3N0cmluZycpIHtcclxuICAgIGVycm9ycy5wdXNoKHtcclxuICAgICAgZmllbGQ6IGZpZWxkTmFtZSxcclxuICAgICAgbWVzc2FnZTogJ1ppcCBjb2RlIG11c3QgYmUgYSBzdHJpbmcnLFxyXG4gICAgICB2YWx1ZTogemlwXHJcbiAgICB9KVxyXG4gIH0gZWxzZSBpZiAoIVZBTElEQVRJT05fUEFUVEVSTlMuemlwLnRlc3QoemlwKSkge1xyXG4gICAgZXJyb3JzLnB1c2goe1xyXG4gICAgICBmaWVsZDogZmllbGROYW1lLFxyXG4gICAgICBtZXNzYWdlOiAnWmlwIGNvZGUgbXVzdCBiZSBtYXhpbXVtIDEyIGNoYXJhY3RlcnMnLFxyXG4gICAgICB2YWx1ZTogemlwXHJcbiAgICB9KVxyXG4gIH1cclxuICBcclxuICByZXR1cm4ge1xyXG4gICAgaXNWYWxpZDogZXJyb3JzLmxlbmd0aCA9PT0gMCxcclxuICAgIGVycm9yc1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFZhbGlkYXRlcyByZXF1aXJlZCBzdHJpbmcgZmllbGRzXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVSZXF1aXJlZFN0cmluZyh2YWx1ZTogc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZCwgZmllbGROYW1lOiBzdHJpbmcpOiBWYWxpZGF0aW9uUmVzdWx0IHtcclxuICBjb25zdCBlcnJvcnM6IFZhbGlkYXRpb25FcnJvcltdID0gW11cclxuICBcclxuICBpZiAoIXZhbHVlIHx8ICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnICYmIHZhbHVlLnRyaW0oKS5sZW5ndGggPT09IDApKSB7XHJcbiAgICBlcnJvcnMucHVzaCh7XHJcbiAgICAgIGZpZWxkOiBmaWVsZE5hbWUsXHJcbiAgICAgIG1lc3NhZ2U6IGAke2ZpZWxkTmFtZX0gaXMgcmVxdWlyZWRgLFxyXG4gICAgICB2YWx1ZVxyXG4gICAgfSlcclxuICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3N0cmluZycpIHtcclxuICAgIGVycm9ycy5wdXNoKHtcclxuICAgICAgZmllbGQ6IGZpZWxkTmFtZSxcclxuICAgICAgbWVzc2FnZTogYCR7ZmllbGROYW1lfSBtdXN0IGJlIGEgc3RyaW5nYCxcclxuICAgICAgdmFsdWVcclxuICAgIH0pXHJcbiAgfVxyXG4gIFxyXG4gIHJldHVybiB7XHJcbiAgICBpc1ZhbGlkOiBlcnJvcnMubGVuZ3RoID09PSAwLFxyXG4gICAgZXJyb3JzXHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogVmFsaWRhdGVzIGFjY291bnQgZGF0YSBhY2NvcmRpbmcgdG8gY29udHJhY3QgcmVxdWlyZW1lbnRzXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVBY2NvdW50RGF0YShkYXRhOiBhbnkpOiBWYWxpZGF0aW9uUmVzdWx0IHtcclxuICBjb25zdCBlcnJvcnM6IFZhbGlkYXRpb25FcnJvcltdID0gW11cclxuICBcclxuICAvLyBSZXF1aXJlZCBmaWVsZHNcclxuICBjb25zdCBhY2NvdW50TmFtZVJlc3VsdCA9IHZhbGlkYXRlUmVxdWlyZWRTdHJpbmcoZGF0YS5hY2NvdW50TmFtZSwgJ0FjY291bnQgTmFtZScpXHJcbiAgZXJyb3JzLnB1c2goLi4uYWNjb3VudE5hbWVSZXN1bHQuZXJyb3JzKVxyXG4gIFxyXG4gIGNvbnN0IGFjY291bnRUeXBlUmVzdWx0ID0gdmFsaWRhdGVSZXF1aXJlZFN0cmluZyhkYXRhLmFjY291bnRUeXBlSWQsICdBY2NvdW50IFR5cGUnKVxyXG4gIGVycm9ycy5wdXNoKC4uLmFjY291bnRUeXBlUmVzdWx0LmVycm9ycylcclxuICBcclxuICAvLyBPcHRpb25hbCBmaWVsZHMgd2l0aCBmb3JtYXQgdmFsaWRhdGlvblxyXG4gIGlmIChkYXRhLndlYnNpdGVVcmwpIHtcclxuICAgIGNvbnN0IHVybFJlc3VsdCA9IHZhbGlkYXRlVXJsKGRhdGEud2Vic2l0ZVVybCwgJ1dlYnNpdGUgVVJMJylcclxuICAgIGVycm9ycy5wdXNoKC4uLnVybFJlc3VsdC5lcnJvcnMpXHJcbiAgfVxyXG4gIFxyXG4gIC8vIEFkZHJlc3MgdmFsaWRhdGlvblxyXG4gIGlmIChkYXRhLnNoaXBwaW5nQWRkcmVzcykge1xyXG4gICAgY29uc3Qgc2hpcHBpbmdTdGF0ZVJlc3VsdCA9IHZhbGlkYXRlU3RhdGUoZGF0YS5zaGlwcGluZ0FkZHJlc3Muc3RhdGUsICdTaGlwcGluZyBTdGF0ZScpXHJcbiAgICBlcnJvcnMucHVzaCguLi5zaGlwcGluZ1N0YXRlUmVzdWx0LmVycm9ycylcclxuICAgIFxyXG4gICAgY29uc3Qgc2hpcHBpbmdaaXBSZXN1bHQgPSB2YWxpZGF0ZVppcChkYXRhLnNoaXBwaW5nQWRkcmVzcy5wb3N0YWxDb2RlLCAnU2hpcHBpbmcgWmlwJylcclxuICAgIGVycm9ycy5wdXNoKC4uLnNoaXBwaW5nWmlwUmVzdWx0LmVycm9ycylcclxuICB9XHJcbiAgXHJcbiAgaWYgKGRhdGEuYmlsbGluZ0FkZHJlc3MpIHtcclxuICAgIGNvbnN0IGJpbGxpbmdTdGF0ZVJlc3VsdCA9IHZhbGlkYXRlU3RhdGUoZGF0YS5iaWxsaW5nQWRkcmVzcy5zdGF0ZSwgJ0JpbGxpbmcgU3RhdGUnKVxyXG4gICAgZXJyb3JzLnB1c2goLi4uYmlsbGluZ1N0YXRlUmVzdWx0LmVycm9ycylcclxuICAgIFxyXG4gICAgY29uc3QgYmlsbGluZ1ppcFJlc3VsdCA9IHZhbGlkYXRlWmlwKGRhdGEuYmlsbGluZ0FkZHJlc3MucG9zdGFsQ29kZSwgJ0JpbGxpbmcgWmlwJylcclxuICAgIGVycm9ycy5wdXNoKC4uLmJpbGxpbmdaaXBSZXN1bHQuZXJyb3JzKVxyXG4gIH1cclxuICBcclxuICByZXR1cm4ge1xyXG4gICAgaXNWYWxpZDogZXJyb3JzLmxlbmd0aCA9PT0gMCxcclxuICAgIGVycm9yc1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFZhbGlkYXRlcyBjb250YWN0IGRhdGEgYWNjb3JkaW5nIHRvIGNvbnRyYWN0IHJlcXVpcmVtZW50c1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlQ29udGFjdERhdGEoZGF0YTogYW55KTogVmFsaWRhdGlvblJlc3VsdCB7XHJcbiAgY29uc3QgZXJyb3JzOiBWYWxpZGF0aW9uRXJyb3JbXSA9IFtdXHJcbiAgXHJcbiAgLy8gUmVxdWlyZWQgZmllbGRzXHJcbiAgY29uc3QgZmlyc3ROYW1lUmVzdWx0ID0gdmFsaWRhdGVSZXF1aXJlZFN0cmluZyhkYXRhLmZpcnN0TmFtZSwgJ0ZpcnN0IE5hbWUnKVxyXG4gIGVycm9ycy5wdXNoKC4uLmZpcnN0TmFtZVJlc3VsdC5lcnJvcnMpXHJcbiAgXHJcbiAgY29uc3QgbGFzdE5hbWVSZXN1bHQgPSB2YWxpZGF0ZVJlcXVpcmVkU3RyaW5nKGRhdGEubGFzdE5hbWUsICdMYXN0IE5hbWUnKVxyXG4gIGVycm9ycy5wdXNoKC4uLmxhc3ROYW1lUmVzdWx0LmVycm9ycylcclxuICBcclxuICBjb25zdCBhY2NvdW50SWRSZXN1bHQgPSB2YWxpZGF0ZVJlcXVpcmVkU3RyaW5nKGRhdGEuYWNjb3VudElkLCAnQWNjb3VudCcpXHJcbiAgZXJyb3JzLnB1c2goLi4uYWNjb3VudElkUmVzdWx0LmVycm9ycylcclxuICBcclxuICAvLyBPcHRpb25hbCBmaWVsZHMgd2l0aCBmb3JtYXQgdmFsaWRhdGlvblxyXG4gIGlmIChkYXRhLmVtYWlsQWRkcmVzcykge1xyXG4gICAgY29uc3QgZW1haWxSZXN1bHQgPSB2YWxpZGF0ZUVtYWlsKGRhdGEuZW1haWxBZGRyZXNzKVxyXG4gICAgZXJyb3JzLnB1c2goLi4uZW1haWxSZXN1bHQuZXJyb3JzKVxyXG4gIH1cclxuICBcclxuICBpZiAoZGF0YS53b3JrUGhvbmUpIHtcclxuICAgIGNvbnN0IHdvcmtQaG9uZVJlc3VsdCA9IHZhbGlkYXRlUGhvbmUoZGF0YS53b3JrUGhvbmUsICdXb3JrIFBob25lJylcclxuICAgIGVycm9ycy5wdXNoKC4uLndvcmtQaG9uZVJlc3VsdC5lcnJvcnMpXHJcbiAgfVxyXG4gIFxyXG4gIGlmIChkYXRhLm1vYmlsZVBob25lKSB7XHJcbiAgICBjb25zdCBtb2JpbGVQaG9uZVJlc3VsdCA9IHZhbGlkYXRlUGhvbmUoZGF0YS5tb2JpbGVQaG9uZSwgJ01vYmlsZSBQaG9uZScpXHJcbiAgICBlcnJvcnMucHVzaCguLi5tb2JpbGVQaG9uZVJlc3VsdC5lcnJvcnMpXHJcbiAgfVxyXG4gIFxyXG4gIHJldHVybiB7XHJcbiAgICBpc1ZhbGlkOiBlcnJvcnMubGVuZ3RoID09PSAwLFxyXG4gICAgZXJyb3JzXHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogRm9ybWF0cyBwaG9uZSBudW1iZXIgdG8geHh4LXh4eC14eHh4IGZvcm1hdFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdFBob25lTnVtYmVyKHBob25lOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gIGlmICghcGhvbmUpIHJldHVybiAnJ1xyXG4gIFxyXG4gIC8vIFJlbW92ZSBhbGwgbm9uLWRpZ2l0IGNoYXJhY3RlcnNcclxuICBjb25zdCBkaWdpdHMgPSBwaG9uZS5yZXBsYWNlKC9cXEQvZywgJycpXHJcbiAgXHJcbiAgLy8gRm9ybWF0IGFzIHh4eC14eHgteHh4eFxyXG4gIGlmIChkaWdpdHMubGVuZ3RoID09PSAxMCkge1xyXG4gICAgcmV0dXJuIGAke2RpZ2l0cy5zbGljZSgwLCAzKX0tJHtkaWdpdHMuc2xpY2UoMywgNil9LSR7ZGlnaXRzLnNsaWNlKDYpfWBcclxuICB9XHJcbiAgXHJcbiAgcmV0dXJuIHBob25lIC8vIFJldHVybiBvcmlnaW5hbCBpZiBub3QgMTAgZGlnaXRzXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBOb3JtYWxpemVzIGVtYWlsIGFkZHJlc3MgKGxvd2VyY2FzZSwgdHJpbSlcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBub3JtYWxpemVFbWFpbChlbWFpbDogc3RyaW5nKTogc3RyaW5nIHtcclxuICBpZiAoIWVtYWlsKSByZXR1cm4gJydcclxuICByZXR1cm4gZW1haWwudG9Mb3dlckNhc2UoKS50cmltKClcclxufVxyXG5cclxuLyoqXHJcbiAqIE5vcm1hbGl6ZXMgc3RhdGUgY29kZSAodXBwZXJjYXNlLCB0cmltKVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIG5vcm1hbGl6ZVN0YXRlKHN0YXRlOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gIGlmICghc3RhdGUpIHJldHVybiAnJ1xyXG4gIHJldHVybiBzdGF0ZS50b1VwcGVyQ2FzZSgpLnRyaW0oKVxyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlcyBhIHN0YW5kYXJkaXplZCB2YWxpZGF0aW9uIGVycm9yIHJlc3BvbnNlXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVmFsaWRhdGlvbkVycm9yUmVzcG9uc2UoZXJyb3JzOiBWYWxpZGF0aW9uRXJyb3JbXSk6IFJlc3BvbnNlIHtcclxuICByZXR1cm4gbmV3IFJlc3BvbnNlKFxyXG4gICAgSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICBlcnJvcjogJ1ZhbGlkYXRpb24gZmFpbGVkJyxcclxuICAgICAgZGV0YWlsczogZXJyb3JzXHJcbiAgICB9KSxcclxuICAgIHtcclxuICAgICAgc3RhdHVzOiA0MDAsXHJcbiAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9XHJcbiAgICB9XHJcbiAgKVxyXG59XHJcbiJdLCJuYW1lcyI6WyJWQUxJREFUSU9OX1BBVFRFUk5TIiwiZW1haWwiLCJwaG9uZSIsInVybCIsInN0YXRlIiwiemlwIiwiVVNfU1RBVEVfQ09ERVMiLCJ2YWxpZGF0ZUVtYWlsIiwiZXJyb3JzIiwiaXNWYWxpZCIsInB1c2giLCJmaWVsZCIsIm1lc3NhZ2UiLCJ2YWx1ZSIsInRlc3QiLCJsZW5ndGgiLCJ2YWxpZGF0ZVBob25lIiwiZmllbGROYW1lIiwidmFsaWRhdGVVcmwiLCJ2YWxpZGF0ZVN0YXRlIiwiaW5jbHVkZXMiLCJ2YWxpZGF0ZVppcCIsInZhbGlkYXRlUmVxdWlyZWRTdHJpbmciLCJ0cmltIiwidmFsaWRhdGVBY2NvdW50RGF0YSIsImRhdGEiLCJhY2NvdW50TmFtZVJlc3VsdCIsImFjY291bnROYW1lIiwiYWNjb3VudFR5cGVSZXN1bHQiLCJhY2NvdW50VHlwZUlkIiwid2Vic2l0ZVVybCIsInVybFJlc3VsdCIsInNoaXBwaW5nQWRkcmVzcyIsInNoaXBwaW5nU3RhdGVSZXN1bHQiLCJzaGlwcGluZ1ppcFJlc3VsdCIsInBvc3RhbENvZGUiLCJiaWxsaW5nQWRkcmVzcyIsImJpbGxpbmdTdGF0ZVJlc3VsdCIsImJpbGxpbmdaaXBSZXN1bHQiLCJ2YWxpZGF0ZUNvbnRhY3REYXRhIiwiZmlyc3ROYW1lUmVzdWx0IiwiZmlyc3ROYW1lIiwibGFzdE5hbWVSZXN1bHQiLCJsYXN0TmFtZSIsImFjY291bnRJZFJlc3VsdCIsImFjY291bnRJZCIsImVtYWlsQWRkcmVzcyIsImVtYWlsUmVzdWx0Iiwid29ya1Bob25lIiwid29ya1Bob25lUmVzdWx0IiwibW9iaWxlUGhvbmUiLCJtb2JpbGVQaG9uZVJlc3VsdCIsImZvcm1hdFBob25lTnVtYmVyIiwiZGlnaXRzIiwicmVwbGFjZSIsInNsaWNlIiwibm9ybWFsaXplRW1haWwiLCJ0b0xvd2VyQ2FzZSIsIm5vcm1hbGl6ZVN0YXRlIiwidG9VcHBlckNhc2UiLCJjcmVhdGVWYWxpZGF0aW9uRXJyb3JSZXNwb25zZSIsIlJlc3BvbnNlIiwiSlNPTiIsInN0cmluZ2lmeSIsImVycm9yIiwiZGV0YWlscyIsInN0YXR1cyIsImhlYWRlcnMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/validation.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/bcryptjs"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Faccounts%2Froute&page=%2Fapi%2Faccounts%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Faccounts%2Froute.ts&appDir=C%3A%5CUsers%5CAdministrator%5C.cursor-projects%5Cprojects%5CCommissable%20CRM%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CAdministrator%5C.cursor-projects%5Cprojects%5CCommissable%20CRM&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();